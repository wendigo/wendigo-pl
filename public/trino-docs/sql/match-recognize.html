


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="insert.html">
      
      
        <link rel="next" href="merge.html">
      
      
      <link rel="icon" href="">
    
    
      
        <title>MATCH_RECOGNIZE - Trino 476-SNAPSHOT Documentation</title>
      
    
    
      
        
      
      


    
    
      
    
    
      
        
        
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
        <link rel="stylesheet" type="text/css" href="../_static/sphinx_immaterial_theme.96fe8683ff2bd71e9.min.css?v=13adf062" />
        <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
        <link rel="stylesheet" type="text/css" href="../_static/trino.css?v=c5cc3cca" />
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../index.html" title="Trino 476-SNAPSHOT Documentation" class="md-header__button md-logo" aria-label="Trino 476-SNAPSHOT Documentation" data-md-component="logo">
      <img src="../_static/trino.svg" alt="logo">
    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Trino 476-SNAPSHOT Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              MATCH_RECOGNIZE
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/trinodb/trino" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg>
  </div>
  <div class="md-source__repository">
    Trino
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="Trino 476-SNAPSHOT Documentation" class="md-nav__button md-logo" aria-label="Trino 476-SNAPSHOT Documentation" data-md-component="logo">
      <img src="../_static/trino.svg" alt="logo">
    </a>
    Trino 476-SNAPSHOT Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/trinodb/trino" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg>
  </div>
  <div class="md-source__repository">
    Trino
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../overview.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../installation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../client.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Clients
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../security.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Security
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../admin.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Administration
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../optimizer.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Query optimizer
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../connector.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Connectors
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../object-storage.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Object storage
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../functions.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Functions and operators
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../udf.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    User-<wbr>defined functions
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../language.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SQL language
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_12" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../sql.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    SQL statement syntax
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_12" id="__nav_12_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_12_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_12">
            <span class="md-nav__icon md-icon"></span>
            SQL statement syntax
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="alter-materialized-view.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ALTER MATERIALIZED VIEW
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="alter-schema.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ALTER SCHEMA
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="alter-table.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ALTER TABLE
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="alter-view.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ALTER VIEW
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="analyze.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ANALYZE
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="call.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CALL
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="comment.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    COMMENT
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="commit.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    COMMIT
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="create-catalog.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CREATE CATALOG
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="create-function.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CREATE FUNCTION
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="create-materialized-view.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CREATE MATERIALIZED VIEW
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="create-role.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CREATE ROLE
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="create-schema.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CREATE SCHEMA
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="create-table.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CREATE TABLE
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="create-table-as.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CREATE TABLE AS
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="create-view.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CREATE VIEW
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="deallocate-prepare.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DEALLOCATE PREPARE
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="delete.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DELETE
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="deny.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DENY
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="describe.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DESCRIBE
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="describe-input.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DESCRIBE INPUT
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="describe-output.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DESCRIBE OUTPUT
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="drop-catalog.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DROP CATALOG
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="drop-function.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DROP FUNCTION
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="drop-materialized-view.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DROP MATERIALIZED VIEW
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="drop-role.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DROP ROLE
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="drop-schema.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DROP SCHEMA
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="drop-table.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DROP TABLE
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="drop-view.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DROP VIEW
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="execute.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    EXECUTE
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="execute-immediate.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    EXECUTE IMMEDIATE
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="explain.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    EXPLAIN
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="explain-analyze.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    EXPLAIN ANALYZE
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="grant.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    GRANT privilege
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="grant-roles.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    GRANT role
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="insert.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    INSERT
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      <a href="#" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    MATCH_<wbr>RECOGNIZE
    
  </span>
  

      </a>
      
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="merge.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MERGE
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="prepare.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PREPARE
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="refresh-materialized-view.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    REFRESH MATERIALIZED VIEW
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="reset-session.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RESET SESSION
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="reset-session-authorization.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RESET SESSION AUTHORIZATION
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="revoke.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    REVOKE privilege
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="revoke-roles.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    REVOKE role
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="rollback.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ROLLBACK
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="select.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SELECT
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="set-path.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SET PATH
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="set-role.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SET ROLE
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="set-session.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SET SESSION
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="set-session-authorization.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SET SESSION AUTHORIZATION
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="set-time-zone.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SET TIME ZONE
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="show-catalogs.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SHOW CATALOGS
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="show-columns.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SHOW COLUMNS
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="show-create-function.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SHOW CREATE FUNCTION
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="show-create-materialized-view.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SHOW CREATE MATERIALIZED VIEW
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="show-create-schema.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SHOW CREATE SCHEMA
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="show-create-table.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SHOW CREATE TABLE
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="show-create-view.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SHOW CREATE VIEW
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="show-functions.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SHOW FUNCTIONS
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="show-grants.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SHOW GRANTS
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="show-role-grants.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SHOW ROLE GRANTS
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="show-roles.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SHOW ROLES
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="show-schemas.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SHOW SCHEMAS
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="show-session.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SHOW SESSION
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="show-stats.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SHOW STATS
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="show-tables.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SHOW TABLES
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="start-transaction.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    START TRANSACTION
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="truncate.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    TRUNCATE
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="update.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    UPDATE
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="use.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    USE
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="values.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    VALUES
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="pattern-recognition-in-window.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Row pattern recognition in window structures
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../develop.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Developer guide
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../glossary.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Glossary
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../appendix.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Appendix
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../release.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Release notes
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset" role="main">
                
                
                  


<h1 id="match-recognize">MATCH_RECOGNIZE<a class="headerlink" href="#match-recognize" title="Link to this heading">#</a></h1>
<h2 id="synopsis">Synopsis<a class="headerlink" href="#synopsis" title="Link to this heading">#</a></h2>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><code>MATCH_RECOGNIZE (
  [ PARTITION BY column [, ...] ]
  [ ORDER BY column [, ...] ]
  [ MEASURES measure_definition [, ...] ]
  [ rows_per_match ]
  [ AFTER MATCH skip_to ]
  PATTERN ( row_pattern )
  [ SUBSET subset_definition [, ...] ]
  DEFINE variable_definition [, ...]
  )
</code></pre></div>
</div>
<h2 id="description">Description<a class="headerlink" href="#description" title="Link to this heading">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">MATCH_RECOGNIZE</span></code> clause is an optional subclause of the <code class="docutils literal notranslate"><span class="pre">FROM</span></code> clause.
It is used to detect patterns in a set of rows. Patterns of interest are
specified using row pattern syntax based on regular expressions. The input to
pattern matching is a table, a view or a subquery. For each detected match, one
or more rows are returned. They contain requested information about the match.</p>
<p>Row pattern matching is a powerful tool when analyzing complex sequences of
events. The following examples show some of the typical use cases:</p>
<ul class="simple">
<li><p>in trade applications, tracking trends or identifying customers with specific
behavioral patterns</p></li>
<li><p>in shipping applications, tracking packages through all possible valid paths,</p></li>
<li><p>in financial applications, detecting unusual incidents, which might signal
fraud</p></li>
</ul>
<h2 id="example">Example<a class="headerlink" href="#example" title="Link to this heading">#</a></h2>
<p>In the following example, the pattern describes a V-shape over the
<code class="docutils literal notranslate"><span class="pre">totalprice</span></code> column. A match is found whenever orders made by a customer
first decrease in price, and then increase past the starting point:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">orders</span><span class="w"> </span><span class="n">MATCH_RECOGNIZE</span><span class="p">(</span>
<span class="w">     </span><span class="n">PARTITION</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">custkey</span>
<span class="w">     </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">orderdate</span>
<span class="w">     </span><span class="n">MEASURES</span>
<span class="w">              </span><span class="n">A</span><span class="p">.</span><span class="n">totalprice</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">starting_price</span><span class="p">,</span>
<span class="w">              </span><span class="k">LAST</span><span class="p">(</span><span class="n">B</span><span class="p">.</span><span class="n">totalprice</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">bottom_price</span><span class="p">,</span>
<span class="w">              </span><span class="k">LAST</span><span class="p">(</span><span class="n">U</span><span class="p">.</span><span class="n">totalprice</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">top_price</span>
<span class="w">     </span><span class="n">ONE</span><span class="w"> </span><span class="k">ROW</span><span class="w"> </span><span class="n">PER</span><span class="w"> </span><span class="k">MATCH</span>
<span class="w">     </span><span class="k">AFTER</span><span class="w"> </span><span class="k">MATCH</span><span class="w"> </span><span class="n">SKIP</span><span class="w"> </span><span class="n">PAST</span><span class="w"> </span><span class="k">LAST</span><span class="w"> </span><span class="k">ROW</span>
<span class="w">     </span><span class="n">PATTERN</span><span class="w"> </span><span class="p">(</span><span class="n">A</span><span class="w"> </span><span class="n">B</span><span class="o">+</span><span class="w"> </span><span class="k">C</span><span class="o">+</span><span class="w"> </span><span class="n">D</span><span class="o">+</span><span class="p">)</span>
<span class="w">     </span><span class="n">SUBSET</span><span class="w"> </span><span class="n">U</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">C</span><span class="p">,</span><span class="w"> </span><span class="n">D</span><span class="p">)</span>
<span class="w">     </span><span class="n">DEFINE</span>
<span class="w">              </span><span class="n">B</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">totalprice</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">PREV</span><span class="p">(</span><span class="n">totalprice</span><span class="p">),</span>
<span class="w">              </span><span class="k">C</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">totalprice</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">PREV</span><span class="p">(</span><span class="n">totalprice</span><span class="p">)</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">totalprice</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">A</span><span class="p">.</span><span class="n">totalprice</span><span class="p">,</span>
<span class="w">              </span><span class="n">D</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">totalprice</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">PREV</span><span class="p">(</span><span class="n">totalprice</span><span class="p">)</span>
<span class="w">     </span><span class="p">)</span>
</code></pre></div>
</div>
<p>In the following sections, all subclauses of the <code class="docutils literal notranslate"><span class="pre">MATCH_RECOGNIZE</span></code> clause are
explained with this example query.</p>
<h2 id="partitioning-and-ordering">Partitioning and ordering<a class="headerlink" href="#partitioning-and-ordering" title="Link to this heading">#</a></h2>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="n">PARTITION</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">custkey</span>
</code></pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">PARTITION</span> <span class="pre">BY</span></code> clause allows you to break up the input table into
separate sections, that are independently processed for pattern matching.
Without a partition declaration, the whole input table is used. This behavior
is analogous to the semantics of <code class="docutils literal notranslate"><span class="pre">PARTITION</span> <span class="pre">BY</span></code> clause in <a class="reference internal" href="select.html#window-clause"><span class="std std-ref">window specification</span></a>. In the example, the <code class="docutils literal notranslate"><span class="pre">orders</span></code> table is
partitioned by the <code class="docutils literal notranslate"><span class="pre">custkey</span></code> value, so that pattern matching is performed for
all orders of a specific customer independently from orders of other
customers.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">orderdate</span>
</code></pre></div>
</div>
<p>The optional <code class="docutils literal notranslate"><span class="pre">ORDER</span> <span class="pre">BY</span></code> clause is generally useful to allow matching on an
ordered data set. For example, sorting the input by <code class="docutils literal notranslate"><span class="pre">orderdate</span></code> allows for
matching on a trend of changes over time.</p>
<h2 id="row-pattern-measures"><span id="id1"></span>Row pattern measures<a class="headerlink" href="#row-pattern-measures" title="Link to this heading">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">MEASURES</span></code> clause allows to specify what information is retrieved from a
matched sequence of rows.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><code>MEASURES measure_expression AS measure_name [, ...]
</code></pre></div>
</div>
<p>A measure expression is a scalar expression whose value is computed based on a
match. In the example, three row pattern measures are specified:</p>
<p><code class="docutils literal notranslate"><span class="pre">A.totalprice</span> <span class="pre">AS</span> <span class="pre">starting_price</span></code> returns the price in the first row of the
match, which is the only row associated with <code class="docutils literal notranslate"><span class="pre">A</span></code> according to the pattern.</p>
<p><code class="docutils literal notranslate"><span class="pre">LAST(B.totalprice)</span> <span class="pre">AS</span> <span class="pre">bottom_price</span></code> returns the lowest price (corresponding
to the bottom of the “V” in the pattern). It is the price in the last row
associated with <code class="docutils literal notranslate"><span class="pre">B</span></code>, which is the last row of the descending section.</p>
<p><code class="docutils literal notranslate"><span class="pre">LAST(U.totalprice)</span> <span class="pre">AS</span> <span class="pre">top_price</span></code> returns the highest price in the match. It
is the price in the last row associated with <code class="docutils literal notranslate"><span class="pre">C</span></code> or <code class="docutils literal notranslate"><span class="pre">D</span></code>, which is also the
final row of the match.</p>
<p>Measure expressions can refer to the columns of the input table. They also
allow special syntax to combine the input information with the details of the
match (see <a class="reference internal" href="#pattern-recognition-expressions"><span class="std std-ref">Row pattern recognition expressions</span></a>).</p>
<p>Each measure defines an output column of the pattern recognition. The column
can be referenced with the <code class="docutils literal notranslate"><span class="pre">measure_name</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">MEASURES</span></code> clause is optional. When no measures are specified, certain
input columns (depending on <a class="reference internal" href="#rows-per-match"><span class="std std-ref">ROWS PER MATCH</span></a> clause) are
the output of the pattern recognition.</p>
<h2 id="rows-per-match"><span id="id2"></span>Rows per match<a class="headerlink" href="#rows-per-match" title="Link to this heading">#</a></h2>
<p>This clause can be used to specify the quantity of output rows. There are two
main options:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="n">ONE</span><span class="w"> </span><span class="k">ROW</span><span class="w"> </span><span class="n">PER</span><span class="w"> </span><span class="k">MATCH</span>
</code></pre></div>
</div>
<p>and</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">ALL</span><span class="w"> </span><span class="k">ROWS</span><span class="w"> </span><span class="n">PER</span><span class="w"> </span><span class="k">MATCH</span>
</code></pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">ONE</span> <span class="pre">ROW</span> <span class="pre">PER</span> <span class="pre">MATCH</span></code> is the default option. For every match, a single row of
output is produced. Output consists of <code class="docutils literal notranslate"><span class="pre">PARTITION</span> <span class="pre">BY</span></code> columns and measures.
The output is also produced for empty matches, based on their starting rows.
Rows that are unmatched (that is, neither included in some non-empty match, nor
being the starting row of an empty match), are not included in the output.</p>
<p>For <code class="docutils literal notranslate"><span class="pre">ALL</span> <span class="pre">ROWS</span> <span class="pre">PER</span> <span class="pre">MATCH</span></code>, every row of a match produces an output row, unless
it is excluded from the output by the <a class="reference internal" href="#exclusion-syntax"><span class="std std-ref">exclusion syntax</span></a>. Output consists
of <code class="docutils literal notranslate"><span class="pre">PARTITION</span> <span class="pre">BY</span></code> columns, <code class="docutils literal notranslate"><span class="pre">ORDER</span> <span class="pre">BY</span></code> columns, measures and remaining
columns from the input table. By default, empty matches are shown and unmatched
rows are skipped, similarly as with the <code class="docutils literal notranslate"><span class="pre">ONE</span> <span class="pre">ROW</span> <span class="pre">PER</span> <span class="pre">MATCH</span></code> option. However,
this behavior can be changed by modifiers:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">ALL</span><span class="w"> </span><span class="k">ROWS</span><span class="w"> </span><span class="n">PER</span><span class="w"> </span><span class="k">MATCH</span><span class="w"> </span><span class="k">SHOW</span><span class="w"> </span><span class="n">EMPTY</span><span class="w"> </span><span class="n">MATCHES</span>
</code></pre></div>
</div>
<p>shows empty matches and skips unmatched rows, like the default.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">ALL</span><span class="w"> </span><span class="k">ROWS</span><span class="w"> </span><span class="n">PER</span><span class="w"> </span><span class="k">MATCH</span><span class="w"> </span><span class="n">OMIT</span><span class="w"> </span><span class="n">EMPTY</span><span class="w"> </span><span class="n">MATCHES</span>
</code></pre></div>
</div>
<p>excludes empty matches from the output.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">ALL</span><span class="w"> </span><span class="k">ROWS</span><span class="w"> </span><span class="n">PER</span><span class="w"> </span><span class="k">MATCH</span><span class="w"> </span><span class="k">WITH</span><span class="w"> </span><span class="n">UNMATCHED</span><span class="w"> </span><span class="k">ROWS</span>
</code></pre></div>
</div>
<p>shows empty matches and produces additional output row for each unmatched row.</p>
<p>There are special rules for computing row pattern measures for empty matches
and unmatched rows. They are explained in
<a class="reference internal" href="#empty-matches-and-unmatched-rows"><span class="std std-ref">Evaluating expressions in empty matches and unmatched rows</span></a>.</p>
<p>Unmatched rows can only occur when the pattern does not allow an empty match.
Otherwise, they are considered as starting rows of empty matches. The option
<code class="docutils literal notranslate"><span class="pre">ALL</span> <span class="pre">ROWS</span> <span class="pre">PER</span> <span class="pre">MATCH</span> <span class="pre">WITH</span> <span class="pre">UNMATCHED</span> <span class="pre">ROWS</span></code> is recommended when pattern
recognition is expected to pass all input rows, and it is not certain whether
the pattern allows an empty match.</p>
<h2 id="after-match-skip"><span id="id3"></span>After match skip<a class="headerlink" href="#after-match-skip" title="Link to this heading">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">AFTER</span> <span class="pre">MATCH</span> <span class="pre">SKIP</span></code> clause specifies where pattern matching resumes after
a non-empty match is found.</p>
<p>The default option is:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">AFTER</span><span class="w"> </span><span class="k">MATCH</span><span class="w"> </span><span class="n">SKIP</span><span class="w"> </span><span class="n">PAST</span><span class="w"> </span><span class="k">LAST</span><span class="w"> </span><span class="k">ROW</span>
</code></pre></div>
</div>
<p>With this option, pattern matching starts from the row after the last row of
the match. Overlapping matches are not detected.</p>
<p>With the following option, pattern matching starts from the second row of the
match:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">AFTER</span><span class="w"> </span><span class="k">MATCH</span><span class="w"> </span><span class="n">SKIP</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="k">NEXT</span><span class="w"> </span><span class="k">ROW</span>
</code></pre></div>
</div>
<p>In the example, if a V-shape is detected, further overlapping matches are
found, starting from consecutive rows on the descending slope of the “V”.
Skipping to the next row is the default behavior after detecting an empty match
or unmatched row.</p>
<p>The following <code class="docutils literal notranslate"><span class="pre">AFTER</span> <span class="pre">MATCH</span> <span class="pre">SKIP</span></code> options allow to resume pattern matching
based on the components of the pattern. Pattern matching starts from the last
(default) or first row matched to a certain row pattern variable. It can be
either a primary pattern variable (they are explained in
<a class="reference internal" href="#row-pattern-syntax"><span class="std std-ref">Row pattern syntax</span></a>) or a
<a class="reference internal" href="#row-pattern-union-variables"><span class="std std-ref">union variable</span></a>:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">AFTER</span><span class="w"> </span><span class="k">MATCH</span><span class="w"> </span><span class="n">SKIP</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="k">FIRST</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">LAST</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="n">pattern_variable</span>
</code></pre></div>
</div>
<p>It is forbidden to skip to the first row of the current match, because it
results in an infinite loop. For example specifying <code class="docutils literal notranslate"><span class="pre">AFTER</span> <span class="pre">MATCH</span> <span class="pre">SKIP</span> <span class="pre">TO</span> <span class="pre">A</span></code>
fails, because <code class="docutils literal notranslate"><span class="pre">A</span></code> is the first element of the pattern, and jumping back to
it creates an infinite loop. Similarly, skipping to a pattern variable which is
not present in the match causes failure.</p>
<p>All other options than the default <code class="docutils literal notranslate"><span class="pre">AFTER</span> <span class="pre">MATCH</span> <span class="pre">SKIP</span> <span class="pre">PAST</span> <span class="pre">LAST</span> <span class="pre">ROW</span></code> allow
detection of overlapping matches. The combination of <code class="docutils literal notranslate"><span class="pre">ALL</span> <span class="pre">ROWS</span> <span class="pre">PER</span> <span class="pre">MATCH</span> <span class="pre">WITH</span> <span class="pre">UNMATCHED</span> <span class="pre">ROWS</span></code> with <code class="docutils literal notranslate"><span class="pre">AFTER</span> <span class="pre">MATCH</span> <span class="pre">SKIP</span> <span class="pre">PAST</span> <span class="pre">LAST</span> <span class="pre">ROW</span></code> is the only
configuration that guarantees exactly one output row for each input row.</p>
<h2 id="row-pattern-syntax"><span id="id4"></span>Row pattern syntax<a class="headerlink" href="#row-pattern-syntax" title="Link to this heading">#</a></h2>
<p>Row pattern is a form of a regular expression with some syntactical extensions
specific to row pattern recognition. It is specified in the <code class="docutils literal notranslate"><span class="pre">PATTERN</span></code>
clause:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="n">PATTERN</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">row_pattern</span><span class="w"> </span><span class="p">)</span>
</code></pre></div>
</div>
<p>The basic element of row pattern is a primary pattern variable. Like pattern
matching in character strings searches for characters, pattern matching in row
sequences searches for rows which can be “labeled” with certain primary pattern
variables. A primary pattern variable has a form of an identifier and is
<a class="reference internal" href="#row-pattern-variable-definitions"><span class="std std-ref">defined</span></a> by a boolean condition. This
condition determines whether a particular input row can be mapped to this
variable and take part in the match.</p>
<p>In the example <code class="docutils literal notranslate"><span class="pre">PATTERN</span> <span class="pre">(A</span> <span class="pre">B+</span> <span class="pre">C+</span> <span class="pre">D+)</span></code>, there are four primary pattern
variables: <code class="docutils literal notranslate"><span class="pre">A</span></code>, <code class="docutils literal notranslate"><span class="pre">B</span></code>, <code class="docutils literal notranslate"><span class="pre">C</span></code>, and <code class="docutils literal notranslate"><span class="pre">D</span></code>.</p>
<p>Row pattern syntax includes the following usage:</p>
<h3 id="concatenation">concatenation<a class="headerlink" href="#concatenation" title="Link to this heading">#</a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><code>A B+ C+ D+
</code></pre></div>
</div>
<p>It is a sequence of components without operators between them. All components
are matched in the same order as they are specified.</p>
<h3 id="alternation">alternation<a class="headerlink" href="#alternation" title="Link to this heading">#</a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><code>A | B | C
</code></pre></div>
</div>
<p>It is a sequence of components separated by <code class="docutils literal notranslate"><span class="pre">|</span></code>. Exactly one of the
components is matched. In case when multiple components can be matched, the
leftmost matching component is chosen.</p>
<h3 id="permutation"><span id="permute-function"></span>permutation<a class="headerlink" href="#permutation" title="Link to this heading">#</a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><code>PERMUTE(A, B, C)
</code></pre></div>
</div>
<p>It is equivalent to alternation of all permutations of its components. All
components are matched in some order. If multiple matches are possible for
different orderings of the components, the match is chosen based on the
lexicographical order established by the order of components in the <code class="docutils literal notranslate"><span class="pre">PERMUTE</span></code>
list. In the above example, the most preferred option is <code class="docutils literal notranslate"><span class="pre">A</span> <span class="pre">B</span> <span class="pre">C</span></code>, and the
least preferred option is <code class="docutils literal notranslate"><span class="pre">C</span> <span class="pre">B</span> <span class="pre">A</span></code>.</p>
<h3 id="grouping">grouping<a class="headerlink" href="#grouping" title="Link to this heading">#</a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><code>(A B C)
</code></pre></div>
</div>
<h3 id="partition-start-anchor">partition start anchor<a class="headerlink" href="#partition-start-anchor" title="Link to this heading">#</a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><code>^
</code></pre></div>
</div>
<h3 id="partition-end-anchor">partition end anchor<a class="headerlink" href="#partition-end-anchor" title="Link to this heading">#</a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><code>$
</code></pre></div>
</div>
<h3 id="empty-pattern">empty pattern<a class="headerlink" href="#empty-pattern" title="Link to this heading">#</a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><code>()
</code></pre></div>
</div>
<h3 id="exclusion-syntax"><span id="id5"></span>exclusion syntax<a class="headerlink" href="#exclusion-syntax" title="Link to this heading">#</a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><code>{- row_pattern -}
</code></pre></div>
</div>
<p>Exclusion syntax is used to specify portions of the match to exclude from the
output. It is useful in combination with the <code class="docutils literal notranslate"><span class="pre">ALL</span> <span class="pre">ROWS</span> <span class="pre">PER</span> <span class="pre">MATCH</span></code> option,
when only certain sections of the match are interesting.</p>
<p>If you change the example to use <code class="docutils literal notranslate"><span class="pre">ALL</span> <span class="pre">ROWS</span> <span class="pre">PER</span> <span class="pre">MATCH</span></code>, and the pattern is
modified to <code class="docutils literal notranslate"><span class="pre">PATTERN</span> <span class="pre">(A</span> <span class="pre">{-</span> <span class="pre">B+</span> <span class="pre">C+</span> <span class="pre">-}</span> <span class="pre">D+)</span></code>, the result consists of the initial
matched row and the trailing section of rows.</p>
<p>Specifying pattern exclusions does not affect the computation of expressions in
<code class="docutils literal notranslate"><span class="pre">MEASURES</span></code> and <code class="docutils literal notranslate"><span class="pre">DEFINE</span></code> clauses. Exclusions also do not affect pattern
matching. They have the same semantics as regular grouping with parentheses.</p>
<p>It is forbidden to specify pattern exclusions with the option <code class="docutils literal notranslate"><span class="pre">ALL</span> <span class="pre">ROWS</span> <span class="pre">PER</span> <span class="pre">MATCH</span> <span class="pre">WITH</span> <span class="pre">UNMATCHED</span> <span class="pre">ROWS</span></code>.</p>
<h3 id="quantifiers">quantifiers<a class="headerlink" href="#quantifiers" title="Link to this heading">#</a></h3>
<p>Pattern quantifiers allow to specify the desired number of repetitions of a
sub-pattern in a match. They are appended after the relevant pattern
component:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="p">(</span><span class="n">A</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">B</span><span class="p">)</span><span class="o">*</span>
</code></pre></div>
</div>
<p>There are following row pattern quantifiers:</p>
<ul class="simple">
<li><p>zero or more repetitions:</p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><code>*
</code></pre></div>
</div>
<ul class="simple">
<li><p>one or more repetitions:</p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><code>+
</code></pre></div>
</div>
<ul class="simple">
<li><p>zero or one repetition:</p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><code>?
</code></pre></div>
</div>
<ul class="simple">
<li><p>exact number of repetitions, specified by a non-negative integer number:</p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><code>{n}
</code></pre></div>
</div>
<ul class="simple">
<li><p>number of repetitions ranging between bounds, specified by non-negative
integer numbers:</p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><code>{m, n}
</code></pre></div>
</div>
<p>Specifying bounds is optional. If the left bound is omitted, it defaults to
<code class="docutils literal notranslate"><span class="pre">0</span></code>. So, <code class="docutils literal notranslate"><span class="pre">{,</span> <span class="pre">5}</span></code> can be described as “between zero and five repetitions”.
If the right bound is omitted, the number of accepted repetitions is unbounded.
So, <code class="docutils literal notranslate"><span class="pre">{5,</span> <span class="pre">}</span></code> can be described as “at least five repetitions”. Also, <code class="docutils literal notranslate"><span class="pre">{,}</span></code> is
equivalent to <code class="docutils literal notranslate"><span class="pre">*</span></code>.</p>
<p>Quantifiers are greedy by default. It means that higher number of repetitions
is preferred over lower number. This behavior can be changed to reluctant by
appending <code class="docutils literal notranslate"><span class="pre">?</span></code> immediately after the quantifier. With <code class="docutils literal notranslate"><span class="pre">{3,</span> <span class="pre">5}</span></code>, 3
repetitions is the least desired option and 5 repetitions – the most desired.
With <code class="docutils literal notranslate"><span class="pre">{3,</span> <span class="pre">5}?</span></code>, 3 repetitions are most desired. Similarly, <code class="docutils literal notranslate"><span class="pre">?</span></code> prefers 1
repetition, while <code class="docutils literal notranslate"><span class="pre">??</span></code> prefers 0 repetitions.</p>
<h2 id="row-pattern-union-variables"><span id="id6"></span>Row pattern union variables<a class="headerlink" href="#row-pattern-union-variables" title="Link to this heading">#</a></h2>
<p>As explained in <a class="reference internal" href="#row-pattern-syntax"><span class="std std-ref">Row pattern syntax</span></a>, primary pattern variables are the
basic elements of row pattern. In addition to primary pattern variables, you
can define union variables. They are introduced in the <code class="docutils literal notranslate"><span class="pre">SUBSET</span></code> clause:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="n">SUBSET</span><span class="w"> </span><span class="n">U</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">C</span><span class="p">,</span><span class="w"> </span><span class="n">D</span><span class="p">),</span><span class="w"> </span><span class="p">...</span>
</code></pre></div>
</div>
<p>In the preceding example, union variable <code class="docutils literal notranslate"><span class="pre">U</span></code> is defined as union of primary
variables <code class="docutils literal notranslate"><span class="pre">C</span></code> and <code class="docutils literal notranslate"><span class="pre">D</span></code>. Union variables are useful in <code class="docutils literal notranslate"><span class="pre">MEASURES</span></code>,
<code class="docutils literal notranslate"><span class="pre">DEFINE</span></code> and <code class="docutils literal notranslate"><span class="pre">AFTER</span> <span class="pre">MATCH</span> <span class="pre">SKIP</span></code> clauses. They allow you to refer to set of
rows matched to either primary variable from a subset.</p>
<p>With the pattern: <code class="docutils literal notranslate"><span class="pre">PATTERN((A</span> <span class="pre">|</span> <span class="pre">B){5}</span> <span class="pre">C+)</span></code> it cannot be determined upfront if
the match contains any <code class="docutils literal notranslate"><span class="pre">A</span></code> or any <code class="docutils literal notranslate"><span class="pre">B</span></code>. A union variable can be used to
access the last row matched to either <code class="docutils literal notranslate"><span class="pre">A</span></code> or <code class="docutils literal notranslate"><span class="pre">B</span></code>. Define <code class="docutils literal notranslate"><span class="pre">SUBSET</span> <span class="pre">U</span> <span class="pre">=</span> <span class="pre">(A,</span> <span class="pre">B)</span></code>, and the expression <code class="docutils literal notranslate"><span class="pre">LAST(U.totalprice)</span></code> returns the value of the
<code class="docutils literal notranslate"><span class="pre">totalprice</span></code> column from the last row mapped to either <code class="docutils literal notranslate"><span class="pre">A</span></code> or <code class="docutils literal notranslate"><span class="pre">B</span></code>. Also,
<code class="docutils literal notranslate"><span class="pre">AFTER</span> <span class="pre">MATCH</span> <span class="pre">SKIP</span> <span class="pre">TO</span> <span class="pre">LAST</span> <span class="pre">A</span></code> or <code class="docutils literal notranslate"><span class="pre">AFTER</span> <span class="pre">MATCH</span> <span class="pre">SKIP</span> <span class="pre">TO</span> <span class="pre">LAST</span> <span class="pre">B</span></code> can result in
failure if <code class="docutils literal notranslate"><span class="pre">A</span></code> or <code class="docutils literal notranslate"><span class="pre">B</span></code> is not present in the match. <code class="docutils literal notranslate"><span class="pre">AFTER</span> <span class="pre">MATCH</span> <span class="pre">SKIP</span> <span class="pre">TO</span> <span class="pre">LAST</span> <span class="pre">U</span></code> does not fail.</p>
<h2 id="row-pattern-variable-definitions"><span id="id7"></span>Row pattern variable definitions<a class="headerlink" href="#row-pattern-variable-definitions" title="Link to this heading">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">DEFINE</span></code> clause is where row pattern primary variables are defined. Each
variable is associated with a boolean condition:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="n">DEFINE</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">totalprice</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">PREV</span><span class="p">(</span><span class="n">totalprice</span><span class="p">),</span><span class="w"> </span><span class="p">...</span>
</code></pre></div>
</div>
<p>During pattern matching, when a certain variable is considered for the next
step of the match, the boolean condition is evaluated in context of the current
match. If the result is <code class="docutils literal notranslate"><span class="pre">true</span></code>, then the current row, “labeled” with the
variable, becomes part of the match.</p>
<p>In the preceding example, assume that the pattern allows to match <code class="docutils literal notranslate"><span class="pre">B</span></code> at some
point. There are some rows already matched to some pattern variables. Now,
variable <code class="docutils literal notranslate"><span class="pre">B</span></code> is being considered for the current row. Before the match is
made, the defining condition for <code class="docutils literal notranslate"><span class="pre">B</span></code> is evaluated. In this example, it is
only true if the value of the <code class="docutils literal notranslate"><span class="pre">totalprice</span></code> column in the current row is lower
than <code class="docutils literal notranslate"><span class="pre">totalprice</span></code> in the preceding row.</p>
<p>The mechanism of matching variables to rows shows the difference between
pattern matching in row sequences and regular expression matching in text. In
text, characters remain constantly in their positions. In row pattern matching,
a row can be mapped to different variables in different matches, depending on
the preceding part of the match, and even on the match number.</p>
<p>It is not required that every primary variable has a definition in the
<code class="docutils literal notranslate"><span class="pre">DEFINE</span></code> clause. Variables not mentioned in the <code class="docutils literal notranslate"><span class="pre">DEFINE</span></code> clause are
implicitly associated with <code class="docutils literal notranslate"><span class="pre">true</span></code> condition, which means that they can be
matched to every row.</p>
<p>Boolean expressions in the <code class="docutils literal notranslate"><span class="pre">DEFINE</span></code> clause allow the same special syntax as
expressions in the <code class="docutils literal notranslate"><span class="pre">MEASURES</span></code> clause. Details are explained in
<a class="reference internal" href="#pattern-recognition-expressions"><span class="std std-ref">Row pattern recognition expressions</span></a>.</p>
<h2 id="row-pattern-recognition-expressions"><span id="pattern-recognition-expressions"></span>Row pattern recognition expressions<a class="headerlink" href="#row-pattern-recognition-expressions" title="Link to this heading">#</a></h2>
<p>Expressions in <a class="reference internal" href="#row-pattern-measures"><span class="std std-ref">MEASURES</span></a> and
<a class="reference internal" href="#row-pattern-variable-definitions"><span class="std std-ref">DEFINE</span></a> clauses are scalar expressions
evaluated over rows of the input table. They support special syntax, specific
to pattern recognition context. They can combine input information with the
information about the current match. Special syntax allows to access pattern
variables assigned to rows, browse rows based on how they are matched, and
refer to the sequential number of the match.</p>
<h3 id="pattern-variable-references">pattern variable references<a class="headerlink" href="#pattern-variable-references" title="Link to this heading">#</a></h3>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="n">A</span><span class="p">.</span><span class="n">totalprice</span>

<span class="n">U</span><span class="p">.</span><span class="n">orderdate</span>

<span class="n">orderstatus</span>
</code></pre></div>
</div>
<p>A column name prefixed with a pattern variable refers to values of this column
in all rows matched to this variable, or to any variable from the subset in
case of union variable. If a column name is not prefixed, it is considered as
prefixed with the <code class="docutils literal notranslate"><span class="pre">universal</span> <span class="pre">pattern</span> <span class="pre">variable</span></code>, defined as union of all
primary pattern variables. In other words, a non-prefixed column name refers to
all rows of the current match.</p>
<p>It is forbidden to prefix a column name with a table name in the pattern
recognition context.</p>
<h3 id="classifier-function"><span id="id8"></span>classifier function<a class="headerlink" href="#classifier-function" title="Link to this heading">#</a></h3>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="n">CLASSIFIER</span><span class="p">()</span>

<span class="n">CLASSIFIER</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="n">CLASSIFIER</span><span class="p">(</span><span class="n">U</span><span class="p">)</span>
</code></pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">classifier</span></code> function returns the primary pattern variable associated
with the row. The return type is <code class="docutils literal notranslate"><span class="pre">varchar</span></code>. The optional argument is a
pattern variable. It limits the rows of interest, the same way as with prefixed
column references. The <code class="docutils literal notranslate"><span class="pre">classifier</span></code> function is particularly useful with a
union variable as the argument. It allows you to determine which variable from
the subset actually matched.</p>
<h3 id="match-number-function"><span id="id9"></span>match_number function<a class="headerlink" href="#match-number-function" title="Link to this heading">#</a></h3>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="n">MATCH_NUMBER</span><span class="p">()</span>
</code></pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">match_number</span></code> function returns the sequential number of the match within
partition, starting from <code class="docutils literal notranslate"><span class="pre">1</span></code>. Empty matches are assigned sequential numbers
as well as non-empty matches. The return type is <code class="docutils literal notranslate"><span class="pre">bigint</span></code>.</p>
<h3 id="logical-navigation-functions"><span id="id10"></span>logical navigation functions<a class="headerlink" href="#logical-navigation-functions" title="Link to this heading">#</a></h3>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">FIRST</span><span class="p">(</span><span class="n">A</span><span class="p">.</span><span class="n">totalprice</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span>
</code></pre></div>
</div>
<p>In the above example, the <code class="docutils literal notranslate"><span class="pre">first</span></code> function navigates to the first row matched
to pattern variable <code class="docutils literal notranslate"><span class="pre">A</span></code>, and then searches forward until it finds two more
occurrences of variable <code class="docutils literal notranslate"><span class="pre">A</span></code> within the match. The result is the value of the
<code class="docutils literal notranslate"><span class="pre">totalprice</span></code> column in that row.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">LAST</span><span class="p">(</span><span class="n">A</span><span class="p">.</span><span class="n">totalprice</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span>
</code></pre></div>
</div>
<p>In the above example, the <code class="docutils literal notranslate"><span class="pre">last</span></code> function navigates to the last row matched
to pattern variable <code class="docutils literal notranslate"><span class="pre">A</span></code>, and then searches backwards until it finds two more
occurrences of variable <code class="docutils literal notranslate"><span class="pre">A</span></code> within the match. The result is the value of the
<code class="docutils literal notranslate"><span class="pre">totalprice</span></code> column in that row.</p>
<p>With the <code class="docutils literal notranslate"><span class="pre">first</span></code> and <code class="docutils literal notranslate"><span class="pre">last</span></code> functions the result is <code class="docutils literal notranslate"><span class="pre">null</span></code>, if the
searched row is not found in the mach.</p>
<p>The second argument is optional. The default value is <code class="docutils literal notranslate"><span class="pre">0</span></code>, which means that
by default these functions navigate to the first or last row of interest. If
specified, the second argument must be a non-negative integer number.</p>
<h3 id="physical-navigation-functions"><span id="id11"></span>physical navigation functions<a class="headerlink" href="#physical-navigation-functions" title="Link to this heading">#</a></h3>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="n">PREV</span><span class="p">(</span><span class="n">A</span><span class="p">.</span><span class="n">totalprice</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span>
</code></pre></div>
</div>
<p>In the above example, the <code class="docutils literal notranslate"><span class="pre">prev</span></code> function navigates to the last row matched
to pattern variable <code class="docutils literal notranslate"><span class="pre">A</span></code>, and then searches two rows backward. The result is
the value of the <code class="docutils literal notranslate"><span class="pre">totalprice</span></code> column in that row.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">NEXT</span><span class="p">(</span><span class="n">A</span><span class="p">.</span><span class="n">totalprice</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span>
</code></pre></div>
</div>
<p>In the above example, the <code class="docutils literal notranslate"><span class="pre">next</span></code> function navigates to the last row matched
to pattern variable <code class="docutils literal notranslate"><span class="pre">A</span></code>, and then searches two rows forward. The result is
the value of the <code class="docutils literal notranslate"><span class="pre">totalprice</span></code> column in that row.</p>
<p>With the <code class="docutils literal notranslate"><span class="pre">prev</span></code> and <code class="docutils literal notranslate"><span class="pre">next</span></code> functions, it is possible to navigate and
retrieve values outside the match. If the navigation goes beyond partition
bounds, the result is <code class="docutils literal notranslate"><span class="pre">null</span></code>.</p>
<p>The second argument is optional. The default value is <code class="docutils literal notranslate"><span class="pre">1</span></code>, which means that
by default these functions navigate to previous or next row. If specified, the
second argument must be a non-negative integer number.</p>
<h3 id="nesting-of-navigation-functions">nesting of navigation functions<a class="headerlink" href="#nesting-of-navigation-functions" title="Link to this heading">#</a></h3>
<p>It is possible to nest logical navigation functions within physical navigation
functions:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="n">PREV</span><span class="p">(</span><span class="k">FIRST</span><span class="p">(</span><span class="n">A</span><span class="p">.</span><span class="n">totalprice</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span>
</code></pre></div>
</div>
<p>In case of nesting, first the logical navigation is performed. It establishes
the starting row for the physical navigation. When both navigation operations
succeed, the value is retrieved from the designated row.</p>
<p>Pattern navigation functions require at least one column reference or
<code class="docutils literal notranslate"><span class="pre">classifier</span></code> function inside of their first argument. The following examples
are correct:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">LAST</span><span class="p">(</span><span class="ss">&quot;pattern_variable_&quot;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">CLASSIFIER</span><span class="p">())</span>

<span class="k">NEXT</span><span class="p">(</span><span class="n">U</span><span class="p">.</span><span class="n">totalprice</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span>
</code></pre></div>
</div>
<p>This is incorrect:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">LAST</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>
</div>
<p>It is also required that all column references and all <code class="docutils literal notranslate"><span class="pre">classifier</span></code> calls
inside a pattern navigation function are consistent in referred pattern
variables. They must all refer either to the same primary variable, the same
union variable, or to the implicit universal pattern variable. The following
examples are correct:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">LAST</span><span class="p">(</span><span class="n">CLASSIFIER</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;A&#39;</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">totalprice</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="cm">/* universal pattern variable */</span>

<span class="k">LAST</span><span class="p">(</span><span class="n">CLASSIFIER</span><span class="p">(</span><span class="n">U</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;A&#39;</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">U</span><span class="p">.</span><span class="n">totalprice</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="cm">/* pattern variable U */</span>
</code></pre></div>
</div>
<p>This is incorrect:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">LAST</span><span class="p">(</span><span class="n">A</span><span class="p">.</span><span class="n">totalprice</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">B</span><span class="p">.</span><span class="n">totalprice</span><span class="p">)</span>
</code></pre></div>
</div>
<h3 id="aggregate-functions">Aggregate functions<a class="headerlink" href="#aggregate-functions" title="Link to this heading">#</a></h3>
<p>It is allowed to use aggregate functions in a row pattern recognition context.
Aggregate functions are evaluated over all rows of the current match or over a
subset of rows based on the matched pattern variables. The
<a class="reference internal" href="#running-and-final"><span class="std std-ref">running and final semantics</span></a> are supported, with
<code class="docutils literal notranslate"><span class="pre">running</span></code> as the default.</p>
<p>The following expression returns the average value of the <code class="docutils literal notranslate"><span class="pre">totalprice</span></code> column
for all rows matched to pattern variable <code class="docutils literal notranslate"><span class="pre">A</span></code>:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">avg</span><span class="p">(</span><span class="n">A</span><span class="p">.</span><span class="n">totalprice</span><span class="p">)</span>
</code></pre></div>
</div>
<p>The following expression returns the average value of the <code class="docutils literal notranslate"><span class="pre">totalprice</span></code> column
for all rows matched to pattern variables from subset <code class="docutils literal notranslate"><span class="pre">U</span></code>:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">avg</span><span class="p">(</span><span class="n">U</span><span class="p">.</span><span class="n">totalprice</span><span class="p">)</span>
</code></pre></div>
</div>
<p>The following expression returns the average value of the <code class="docutils literal notranslate"><span class="pre">totalprice</span></code> column
for all rows of the match:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">avg</span><span class="p">(</span><span class="n">totalprice</span><span class="p">)</span>
</code></pre></div>
</div>
<h4 id="aggregation-arguments">Aggregation arguments<a class="headerlink" href="#aggregation-arguments" title="Link to this heading">#</a></h4>
<p>In case when the aggregate function has multiple arguments, it is required that
all arguments refer consistently to the same set of rows:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="n">max_by</span><span class="p">(</span><span class="n">totalprice</span><span class="p">,</span><span class="w"> </span><span class="n">tax</span><span class="p">)</span><span class="w"> </span><span class="cm">/* aggregate over all rows of the match */</span>

<span class="n">max_by</span><span class="p">(</span><span class="n">CLASSIFIER</span><span class="p">(</span><span class="n">A</span><span class="p">),</span><span class="w"> </span><span class="n">A</span><span class="p">.</span><span class="n">tax</span><span class="p">)</span><span class="w"> </span><span class="cm">/* aggregate over all rows matched to A */</span>
</code></pre></div>
</div>
<p>This is incorrect:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="n">max_by</span><span class="p">(</span><span class="n">A</span><span class="p">.</span><span class="n">totalprice</span><span class="p">,</span><span class="w"> </span><span class="n">tax</span><span class="p">)</span>

<span class="n">max_by</span><span class="p">(</span><span class="n">A</span><span class="p">.</span><span class="n">totalprice</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">.</span><span class="n">tax</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">B</span><span class="p">.</span><span class="n">tax</span><span class="p">)</span>
</code></pre></div>
</div>
<p>If an aggregate argument does not contain any column reference or
<code class="docutils literal notranslate"><span class="pre">classifier</span></code> function, it does not refer to any pattern variable. In such a
case other aggregate arguments determine the set of rows to aggregate over. If
none of the arguments contains a pattern variable reference, the universal row
pattern variable is implicit. This means that the aggregate function applies to
all rows of the match:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">count</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="cm">/* aggregate over all rows of the match */</span>

<span class="n">min_by</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="cm">/* aggregate over all rows of the match */</span>

<span class="n">min_by</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">totalprice</span><span class="p">)</span><span class="w"> </span><span class="cm">/* aggregate over all rows of the match */</span>

<span class="n">min_by</span><span class="p">(</span><span class="n">totalprice</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="cm">/* aggregate over all rows of the match */</span>

<span class="n">min_by</span><span class="p">(</span><span class="n">A</span><span class="p">.</span><span class="n">totalprice</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="cm">/* aggregate over all rows matched to A */</span>

<span class="n">max_by</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">.</span><span class="n">totalprice</span><span class="p">)</span><span class="w"> </span><span class="cm">/* aggregate over all rows matched to A */</span>
</code></pre></div>
</div>
<h4 id="nesting-of-aggregate-functions">Nesting of aggregate functions<a class="headerlink" href="#nesting-of-aggregate-functions" title="Link to this heading">#</a></h4>
<p>Aggregate function arguments must not contain pattern navigation functions.
Similarly, aggregate functions cannot be nested in pattern navigation
functions.</p>
<h4 id="usage-of-the-classifier-and-match-number-functions">Usage of the <code class="docutils literal notranslate"><span class="pre">classifier</span></code> and <code class="docutils literal notranslate"><span class="pre">match_number</span></code> functions<a class="headerlink" href="#usage-of-the-classifier-and-match-number-functions" title="Link to this heading">#</a></h4>
<p>It is allowed to use the <code class="docutils literal notranslate"><span class="pre">classifier</span></code> and <code class="docutils literal notranslate"><span class="pre">match_number</span></code> functions in
aggregate function arguments. The following expression returns an array
containing all matched pattern variables:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="n">array_agg</span><span class="p">(</span><span class="n">CLASSIFIER</span><span class="p">())</span>
</code></pre></div>
</div>
<p>This is particularly useful in combination with the option
<code class="docutils literal notranslate"><span class="pre">ONE</span> <span class="pre">ROW</span> <span class="pre">PER</span> <span class="pre">MATCH</span></code>. It allows to get all the components of the match while
keeping the output size reduced.</p>
<h4 id="row-pattern-count-aggregation">Row pattern count aggregation<a class="headerlink" href="#row-pattern-count-aggregation" title="Link to this heading">#</a></h4>
<p>Like other aggregate functions in a row pattern recognition context, the
<code class="docutils literal notranslate"><span class="pre">count</span></code> function can be applied to all rows of the match, or to rows
associated with certain row pattern variables:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="k">count</span><span class="p">()</span><span class="w"> </span><span class="cm">/* count all rows of the match */</span>

<span class="k">count</span><span class="p">(</span><span class="n">totalprice</span><span class="p">)</span><span class="w"> </span><span class="cm">/* count non-null values of the totalprice column</span>
<span class="cm">                     in all rows of the match */</span>

<span class="k">count</span><span class="p">(</span><span class="n">A</span><span class="p">.</span><span class="n">totalprice</span><span class="p">)</span><span class="w"> </span><span class="cm">/* count non-null values of the totalprice column</span>
<span class="cm">                       in all rows matched to A */</span>
</code></pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">count</span></code> function in a row pattern recognition context allows special syntax
to support the <code class="docutils literal notranslate"><span class="pre">count(*)</span></code> behavior over a limited set of rows:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">count</span><span class="p">(</span><span class="n">A</span><span class="p">.</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="cm">/* count rows matched to A */</span>

<span class="k">count</span><span class="p">(</span><span class="n">U</span><span class="p">.</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="cm">/* count rows matched to pattern variables from subset U */</span>
</code></pre></div>
</div>
<h3 id="running-and-final-semantics"><span id="running-and-final"></span><code class="docutils literal notranslate"><span class="pre">RUNNING</span></code> and <code class="docutils literal notranslate"><span class="pre">FINAL</span></code> semantics<a class="headerlink" href="#running-and-final-semantics" title="Link to this heading">#</a></h3>
<p>During pattern matching in a sequence of rows, one row after another is
examined to determine if it fits the pattern. At any step, a partial match is
known, but it is not yet known what rows will be added in the future or what
pattern variables they will be mapped to. So, when evaluating a boolean
condition in the <code class="docutils literal notranslate"><span class="pre">DEFINE</span></code> clause for the current row, only the preceding part
of the match (plus the current row) is “visible”. This is the <code class="docutils literal notranslate"><span class="pre">running</span></code>
semantics.</p>
<p>When evaluating expressions in the <code class="docutils literal notranslate"><span class="pre">MEASURES</span></code> clause, the match is complete.
It is then possible to apply the <code class="docutils literal notranslate"><span class="pre">final</span></code> semantics. In the <code class="docutils literal notranslate"><span class="pre">final</span></code>
semantics, the whole match is “visible” as from the position of the final row.</p>
<p>In the <code class="docutils literal notranslate"><span class="pre">MEASURES</span></code> clause, the <code class="docutils literal notranslate"><span class="pre">running</span></code> semantics can also be applied. When
outputting information row by row (as in <code class="docutils literal notranslate"><span class="pre">ALL</span> <span class="pre">ROWS</span> <span class="pre">PER</span> <span class="pre">MATCH</span></code>), the
<code class="docutils literal notranslate"><span class="pre">running</span></code> semantics evaluate expressions from the positions of consecutive
rows.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">running</span></code> and <code class="docutils literal notranslate"><span class="pre">final</span></code> semantics are denoted by the keywords:
<code class="docutils literal notranslate"><span class="pre">RUNNING</span></code> and <code class="docutils literal notranslate"><span class="pre">FINAL</span></code>, preceding a logical navigation function <code class="docutils literal notranslate"><span class="pre">first</span></code> or
<code class="docutils literal notranslate"><span class="pre">last</span></code>, or an aggregate function:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="n">RUNNING</span><span class="w"> </span><span class="k">LAST</span><span class="p">(</span><span class="n">A</span><span class="p">.</span><span class="n">totalprice</span><span class="p">)</span>

<span class="k">FINAL</span><span class="w"> </span><span class="k">LAST</span><span class="p">(</span><span class="n">A</span><span class="p">.</span><span class="n">totalprice</span><span class="p">)</span>

<span class="n">RUNNING</span><span class="w"> </span><span class="k">avg</span><span class="p">(</span><span class="n">A</span><span class="p">.</span><span class="n">totalprice</span><span class="p">)</span>

<span class="k">FINAL</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="n">A</span><span class="p">.</span><span class="o">*</span><span class="p">)</span>
</code></pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">running</span></code> semantics is default in <code class="docutils literal notranslate"><span class="pre">MEASURES</span></code> and <code class="docutils literal notranslate"><span class="pre">DEFINE</span></code> clauses.
<code class="docutils literal notranslate"><span class="pre">FINAL</span></code> can only be specified in the <code class="docutils literal notranslate"><span class="pre">MEASURES</span></code> clause.</p>
<p>With the option <code class="docutils literal notranslate"><span class="pre">ONE</span> <span class="pre">ROW</span> <span class="pre">PER</span> <span class="pre">MATCH</span></code>, row pattern measures are evaluated from
the position of the final row in the match. Therefore, <code class="docutils literal notranslate"><span class="pre">running</span></code> and
<code class="docutils literal notranslate"><span class="pre">final</span></code> semantics are the same.</p>
<h2 id="evaluating-expressions-in-empty-matches-and-unmatched-rows"><span id="empty-matches-and-unmatched-rows"></span>Evaluating expressions in empty matches and unmatched rows<a class="headerlink" href="#evaluating-expressions-in-empty-matches-and-unmatched-rows" title="Link to this heading">#</a></h2>
<p>An empty match occurs when the row pattern is successfully matched, but no
pattern variables are assigned. The following pattern produces an empty match
for every row:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="n">PATTERN</span><span class="p">(())</span>
</code></pre></div>
</div>
<p>When evaluating row pattern measures for an empty match:</p>
<ul class="simple">
<li><p>all column references return <code class="docutils literal notranslate"><span class="pre">null</span></code></p></li>
<li><p>all navigation operations return <code class="docutils literal notranslate"><span class="pre">null</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">classifier</span></code> function returns <code class="docutils literal notranslate"><span class="pre">null</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">match_number</span></code> function returns the sequential number of the match</p></li>
<li><p>all aggregate functions are evaluated over an empty set of rows</p></li>
</ul>
<p>Like every match, an empty match has its starting row. All input values which
are to be output along with the measures (as explained in
<a class="reference internal" href="#rows-per-match"><span class="std std-ref">Rows per match</span></a>), are the values from the starting row.</p>
<p>An unmatched row is a row that is neither part of any non-empty match nor the
starting row of an empty match. With the option <code class="docutils literal notranslate"><span class="pre">ALL</span> <span class="pre">ROWS</span> <span class="pre">PER</span> <span class="pre">MATCH</span> <span class="pre">WITH</span> <span class="pre">UNMATCHED</span> <span class="pre">ROWS</span></code>, a single output row is produced. In that row, all row pattern
measures are <code class="docutils literal notranslate"><span class="pre">null</span></code>. All input values which are to be output along with the
measures (as explained in <a class="reference internal" href="#rows-per-match"><span class="std std-ref">Rows per match</span></a>), are the values from the
unmatched row. Using the <code class="docutils literal notranslate"><span class="pre">match_number</span></code> function as a measure can help
differentiate between an empty match and unmatched row.</p>







  
  






                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="insert.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: INSERT">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                INSERT
              </div>
            </div>
          </a>
        
        
          
          <a href="merge.html" class="md-footer__link md-footer__link--next" aria-label="Next: MERGE">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                MERGE
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  
  
  <div class="md-footer-meta md-typeset">
    
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["content.action.edit", "content.action.view", "content.code.copy", "content.tabs.link", "content.tooltipsnavigation.expand", "navigation.footer", "navigation.top", "navigation.tracking", "search.share", "search.suggest", "toc.integrate", "toc.follow"], "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike", "staticVersions": null, "versionPath": "../versions.json"}}</script>
    
      
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/sphinx_immaterial_theme.32136f45f91ae6956.min.js?v=a7a9472a"></script>
        <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../_static/copybutton.js?v=f281be69"></script>
    
  </body>
</html>