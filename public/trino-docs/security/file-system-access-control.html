


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="built-in-system-access-control.html">
      
      
        <link rel="next" href="opa-access-control.html">
      
      
      <link rel="icon" href="">
    
    
      
        <title>File-based access control - Trino 476-SNAPSHOT Documentation</title>
      
    
    
      
        
      
      


    
    
      
    
    
      
        
        
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
        <link rel="stylesheet" type="text/css" href="../_static/sphinx_immaterial_theme.96fe8683ff2bd71e9.min.css?v=13adf062" />
        <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
        <link rel="stylesheet" type="text/css" href="../_static/trino.css?v=c5cc3cca" />
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../index.html" title="Trino 476-SNAPSHOT Documentation" class="md-header__button md-logo" aria-label="Trino 476-SNAPSHOT Documentation" data-md-component="logo">
      <img src="../_static/trino.svg" alt="logo">
    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Trino 476-SNAPSHOT Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              File-based access control
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/trinodb/trino" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg>
  </div>
  <div class="md-source__repository">
    Trino
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="Trino 476-SNAPSHOT Documentation" class="md-nav__button md-logo" aria-label="Trino 476-SNAPSHOT Documentation" data-md-component="logo">
      <img src="../_static/trino.svg" alt="logo">
    </a>
    Trino 476-SNAPSHOT Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/trinodb/trino" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg>
  </div>
  <div class="md-source__repository">
    Trino
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../overview.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../installation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../client.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Clients
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../security.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Security
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Security
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="overview.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Security overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="tls.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    TLS and HTTPS
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="inspect-pem.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PEM files
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="inspect-jks.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    JKS files
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="authentication-types.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Authentication types
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="password-file.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Password file authentication
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="ldap.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    LDAP authentication
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="salesforce.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Salesforce authentication
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="oauth2.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    OAuth 2.<wbr>0 authentication
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="kerberos.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Kerberos authentication
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="certificate.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Certificate authentication
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="jwt.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    JWT authentication
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="user-mapping.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    User mapping
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="group-file.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    File group provider
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="built-in-system-access-control.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    System access control
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      <a href="#" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    File-<wbr>based access control
    
  </span>
  

      </a>
      
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="opa-access-control.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Open Policy Agent access control
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="ranger-access-control.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ranger access control
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="internal-communication.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Secure internal communication
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="secrets.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Secrets
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../admin.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Administration
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../optimizer.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Query optimizer
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../connector.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Connectors
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../object-storage.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Object storage
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../functions.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Functions and operators
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../udf.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    User-<wbr>defined functions
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../language.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SQL language
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../sql.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SQL statement syntax
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../develop.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Developer guide
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../glossary.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Glossary
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../appendix.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Appendix
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../release.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Release notes
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset" role="main">
                
                
                  


<h1 id="file-based-access-control">File-based access control<a class="headerlink" href="#file-based-access-control" title="Link to this heading">#</a></h1>
<p>To secure access to data in your cluster, you can implement file-based access
control where access to data and operations is defined by rules declared in
manually-configured JSON files.</p>
<p>There are two types of file-based access control:</p>
<ul class="simple">
<li><p><strong>System-level access control</strong> uses the access control plugin with a single
JSON file that specifies authorization rules for the whole cluster.</p></li>
<li><p><strong>Catalog-level access control</strong> uses individual JSON files for each catalog
for granular control over the data in that catalog, including column-level
authorization.</p></li>
</ul>
<h2 id="system-level-access-control-files"><span id="system-file-based-access-control"></span>System-level access control files<a class="headerlink" href="#system-level-access-control-files" title="Link to this heading">#</a></h2>
<p>The access control plugin allows you to specify authorization rules for the
cluster in a single JSON file.</p>
<h3 id="configuration">Configuration<a class="headerlink" href="#configuration" title="Link to this heading">#</a></h3>
<p>To use the access control plugin, add an <code class="docutils literal notranslate"><span class="pre">etc/access-control.properties</span></code> file
containing two required properties: <code class="docutils literal notranslate"><span class="pre">access-control.name</span></code>, which must be set
to <code class="docutils literal notranslate"><span class="pre">file</span></code>, and <code class="docutils literal notranslate"><span class="pre">security.config-file</span></code>, which must be set to the location
of the config file. The configuration file location can either point to the local
disc or to a http endpoint. For example, if a config file named <code class="docutils literal notranslate"><span class="pre">rules.json</span></code> resides
in <code class="docutils literal notranslate"><span class="pre">etc</span></code>, add an <code class="docutils literal notranslate"><span class="pre">etc/access-control.properties</span></code> with the following
contents:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><code>access-control.name=file
security.config-file=etc/rules.json
</code></pre></div>
</div>
<p>If the config should be loaded via the http endpoint <code class="docutils literal notranslate"><span class="pre">http://trino-test/config</span></code> and
is wrapped into a JSON object and available via the <code class="docutils literal notranslate"><span class="pre">data</span></code> key <code class="docutils literal notranslate"><span class="pre">etc/access-control.properties</span></code>
should look like this:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><code>access-control.name=file
security.config-file=http://trino-test/config
security.json-pointer=/data
</code></pre></div>
</div>
<p>The config file is specified in JSON format. It contains rules that define which
users have access to which resources. The rules are read from top to bottom and
the first matching rule is applied. If no rule matches, access is denied. A JSON
pointer (RFC 6901) can be specified using the <code class="docutils literal notranslate"><span class="pre">security.json-pointer</span></code> property
to specify a nested object inside the JSON content containing the rules. Per default,
the file is assumed to contain a single object defining the rules rendering
the specification of <code class="docutils literal notranslate"><span class="pre">security.json-pointer</span></code> unnecessary in that case.</p>
<h3 id="refresh">Refresh<a class="headerlink" href="#refresh" title="Link to this heading">#</a></h3>
<p>By default, when a change is made to the JSON rules file, Trino must be
restarted to load the changes. There is an optional property to refresh the
properties without requiring a Trino restart. The refresh period is specified in
the <code class="docutils literal notranslate"><span class="pre">etc/access-control.properties</span></code>:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><code>security.refresh-period=1s
</code></pre></div>
</div>
<h3 id="catalog-schema-and-table-access">Catalog, schema, and table access<a class="headerlink" href="#catalog-schema-and-table-access" title="Link to this heading">#</a></h3>
<p>Access to catalogs, schemas, tables, and views is controlled by the catalog,
schema, and table rules. The catalog rules are coarse-grained rules used to
restrict all access or write access to catalogs. They do not explicitly grant
any specific schema or table permissions. The table and schema rules are used to
specify who can create, drop, alter, select, insert, delete, etc. for schemas
and tables.</p>
<p>For each rule set, permission is based on the first matching rule, read from the
top to the bottom of the configuration file. If no rule matches, access is
denied.</p>
<p>If no rules are provided at all, then access is granted. You can remove
access grant by adding a section with an empty set of rules at that particular
level, for example:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;schemas&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span>
<span class="p">}</span>
</code></pre></div>
</div>
<p>At the catalog level you have to add a single “dummy” rule for each accessible
catalog.</p>
<div class="note admonition">
<p class="admonition-title">Note</p>
<p>These rules do not apply to system-defined tables in the
<code class="docutils literal notranslate"><span class="pre">information_schema</span></code> schema.</p>
</div>
<p>The following table summarizes the permissions required for each SQL command:</p>
<table class="docutils data align-default">
<thead>
<tr class="row-odd"><th class="head"><p>SQL command</p></th>
<th class="head"><p>Catalog</p></th>
<th class="head"><p>Schema</p></th>
<th class="head"><p>Table</p></th>
<th class="head"><p>Note</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SHOW CATALOGS</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p>Always allowed</p></td>
</tr>
<tr class="row-odd"><td><p>SHOW SCHEMAS</p></td>
<td><p>read-only</p></td>
<td><p>any*</p></td>
<td><p>any*</p></td>
<td><p>Allowed if catalog is <a class="reference internal" href="#system-file-auth-visibility"><span class="std std-ref">visible</span></a></p></td>
</tr>
<tr class="row-even"><td><p>SHOW TABLES</p></td>
<td><p>read-only</p></td>
<td><p>any*</p></td>
<td><p>any*</p></td>
<td><p>Allowed if schema <a class="reference internal" href="#system-file-auth-visibility"><span class="std std-ref">visible</span></a></p></td>
</tr>
<tr class="row-odd"><td><p>CREATE SCHEMA</p></td>
<td><p>read-only</p></td>
<td><p>owner</p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>DROP SCHEMA</p></td>
<td><p>all</p></td>
<td><p>owner</p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>SHOW CREATE SCHEMA</p></td>
<td><p>all</p></td>
<td><p>owner</p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>ALTER SCHEMA … RENAME TO</p></td>
<td><p>all</p></td>
<td><p>owner*</p></td>
<td><p></p></td>
<td><p>Ownership is required on both old and new schemas</p></td>
</tr>
<tr class="row-odd"><td><p>ALTER SCHEMA … SET AUTHORIZATION</p></td>
<td><p>all</p></td>
<td><p>owner</p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>CREATE TABLE</p></td>
<td><p>all</p></td>
<td><p></p></td>
<td><p>owner</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>DROP TABLE</p></td>
<td><p>all</p></td>
<td><p></p></td>
<td><p>owner</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>ALTER TABLE … RENAME TO</p></td>
<td><p>all</p></td>
<td><p></p></td>
<td><p>owner*</p></td>
<td><p>Ownership is required on both old and new tables</p></td>
</tr>
<tr class="row-odd"><td><p>ALTER TABLE … SET PROPERTIES</p></td>
<td><p>all</p></td>
<td><p></p></td>
<td><p>owner</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>CREATE VIEW</p></td>
<td><p>all</p></td>
<td><p></p></td>
<td><p>owner</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>DROP VIEW</p></td>
<td><p>all</p></td>
<td><p></p></td>
<td><p>owner</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>ALTER VIEW … RENAME TO</p></td>
<td><p>all</p></td>
<td><p></p></td>
<td><p>owner*</p></td>
<td><p>Ownership is required on both old and new views</p></td>
</tr>
<tr class="row-odd"><td><p>REFRESH MATERIALIZED VIEW</p></td>
<td><p>all</p></td>
<td><p></p></td>
<td><p>update</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>COMMENT ON TABLE</p></td>
<td><p>all</p></td>
<td><p></p></td>
<td><p>owner</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>COMMENT ON COLUMN</p></td>
<td><p>all</p></td>
<td><p></p></td>
<td><p>owner</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>ALTER TABLE … ADD COLUMN</p></td>
<td><p>all</p></td>
<td><p></p></td>
<td><p>owner</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>ALTER TABLE … DROP COLUMN</p></td>
<td><p>all</p></td>
<td><p></p></td>
<td><p>owner</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>ALTER TABLE … RENAME COLUMN</p></td>
<td><p>all</p></td>
<td><p></p></td>
<td><p>owner</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>SHOW COLUMNS</p></td>
<td><p>read-only</p></td>
<td><p></p></td>
<td><p>any</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>SELECT FROM table</p></td>
<td><p>read-only</p></td>
<td><p></p></td>
<td><p>select</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>SELECT FROM view</p></td>
<td><p>read-only</p></td>
<td><p></p></td>
<td><p>select, grant_select</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>INSERT INTO</p></td>
<td><p>all</p></td>
<td><p></p></td>
<td><p>insert</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>DELETE FROM</p></td>
<td><p>all</p></td>
<td><p></p></td>
<td><p>delete</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>UPDATE</p></td>
<td><p>all</p></td>
<td><p></p></td>
<td><p>update</p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<p>Permissions required for executing functions:</p>
<table class="docutils data align-default">
<colgroup>
<col style="width: 30.0%" />
<col style="width: 10.0%" />
<col style="width: 20.0%" />
<col style="width: 40.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>SQL command</p></th>
<th class="head"><p>Catalog</p></th>
<th class="head"><p>Function permission</p></th>
<th class="head"><p>Note</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">SELECT</span> <span class="pre">function()</span></code></p></td>
<td></td>
<td><p><code class="docutils literal notranslate"><span class="pre">execute</span></code>, <code class="docutils literal notranslate"><span class="pre">grant_execute*</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">grant_execute</span></code> is required when the function is used in a <code class="docutils literal notranslate"><span class="pre">SECURITY</span> <span class="pre">DEFINER</span></code> view.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">CREATE</span> <span class="pre">FUNCTION</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">all</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ownership</span></code></p></td>
<td><p>Not all connectors support <a class="reference internal" href="../udf/introduction.html#udf-catalog"><span class="std std-ref">Catalog user-defined functions</span></a>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">DROP</span> <span class="pre">FUNCTION</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">all</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ownership</span></code></p></td>
<td><p>Not all connectors support <a class="reference internal" href="../udf/introduction.html#udf-catalog"><span class="std std-ref">Catalog user-defined functions</span></a>.</p></td>
</tr>
</tbody>
</table>
<h4 id="visibility"><span id="system-file-auth-visibility"></span>Visibility<a class="headerlink" href="#visibility" title="Link to this heading">#</a></h4>
<p>For a catalog, schema, or table to be visible in a <code class="docutils literal notranslate"><span class="pre">SHOW</span></code> command, the user
must have at least one permission on the item or any nested item. The nested
items do not need to already exist as any potential permission makes the item
visible. Specifically:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">catalog</span></code>: Visible if user is the owner of any nested schema, has
permissions on any nested table or function, or has permissions to
set session properties in the catalog.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">schema</span></code>: Visible if the user is the owner of the schema, or has permissions
on any nested table or function.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">table</span></code>: Visible if the user has any permissions on the table.</p></li>
</ul>
<h4 id="catalog-rules">Catalog rules<a class="headerlink" href="#catalog-rules" title="Link to this heading">#</a></h4>
<p>Each catalog rule is composed of the following fields:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">user</span></code> (optional): regex to match against username. Defaults to <code class="docutils literal notranslate"><span class="pre">.*</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">role</span></code> (optional): regex to match against role names. Defaults to <code class="docutils literal notranslate"><span class="pre">.*</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">group</span></code> (optional): regex to match against group names. Defaults to <code class="docutils literal notranslate"><span class="pre">.*</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">catalog</span></code> (optional): regex to match against catalog name. Defaults to
<code class="docutils literal notranslate"><span class="pre">.*</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">allow</span></code> (required): string indicating whether a user has access to the
catalog. This value can be <code class="docutils literal notranslate"><span class="pre">all</span></code>, <code class="docutils literal notranslate"><span class="pre">read-only</span></code> or <code class="docutils literal notranslate"><span class="pre">none</span></code>, and defaults to
<code class="docutils literal notranslate"><span class="pre">none</span></code>. Setting this value to <code class="docutils literal notranslate"><span class="pre">read-only</span></code> has the same behavior as the
<code class="docutils literal notranslate"><span class="pre">read-only</span></code> system access control plugin.</p></li>
</ul>
<p>In order for a rule to apply the username must match the regular expression
specified in <code class="docutils literal notranslate"><span class="pre">user</span></code> attribute.</p>
<p>For role names, a rule can be applied if at least one of the currently enabled
roles matches the <code class="docutils literal notranslate"><span class="pre">role</span></code> regular expression.</p>
<p>For group names, a rule can be applied if at least one group name of this user
matches the <code class="docutils literal notranslate"><span class="pre">group</span></code> regular expression.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">all</span></code> value for <code class="docutils literal notranslate"><span class="pre">allow</span></code> means these rules do not restrict access in any
way, but the schema and table rules can restrict access.</p>
<div class="note admonition">
<p class="admonition-title">Note</p>
<p>By default, all users have access to the <code class="docutils literal notranslate"><span class="pre">system</span></code> catalog. You can
override this behavior by adding a rule.</p>
<p>Boolean <code class="docutils literal notranslate"><span class="pre">true</span></code> and <code class="docutils literal notranslate"><span class="pre">false</span></code> are also supported as legacy values for
<code class="docutils literal notranslate"><span class="pre">allow</span></code>, to support backwards compatibility.  <code class="docutils literal notranslate"><span class="pre">true</span></code> maps to <code class="docutils literal notranslate"><span class="pre">all</span></code>,
and <code class="docutils literal notranslate"><span class="pre">false</span></code> maps to <code class="docutils literal notranslate"><span class="pre">none</span></code>.</p>
</div>
<p>For example, if you want to allow only the role <code class="docutils literal notranslate"><span class="pre">admin</span></code> to access the
<code class="docutils literal notranslate"><span class="pre">mysql</span></code> and the <code class="docutils literal notranslate"><span class="pre">system</span></code> catalog, allow users from the <code class="docutils literal notranslate"><span class="pre">finance</span></code> and
<code class="docutils literal notranslate"><span class="pre">human_resources</span></code> groups access to <code class="docutils literal notranslate"><span class="pre">postgres</span></code> catalog, allow all users to
access the <code class="docutils literal notranslate"><span class="pre">hive</span></code> catalog, and deny all other access, you can use the
following rules:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;catalogs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;role&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;admin&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;catalog&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;(mysql|system)&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;allow&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;all&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;group&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;finance|human_resources&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;catalog&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;postgres&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;allow&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;catalog&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;hive&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;allow&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;all&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;user&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;alice&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;catalog&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;postgresql&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;allow&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;read-only&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;catalog&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;system&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;allow&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;none&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
</div>
<p>For group-based rules to match, users need to be assigned to groups by a
<a class="reference internal" href="../develop/group-provider.html"><span class="doc">Group provider</span></a>.</p>
<h4 id="schema-rules">Schema rules<a class="headerlink" href="#schema-rules" title="Link to this heading">#</a></h4>
<p>Each schema rule is composed of the following fields:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">user</span></code> (optional): regex to match against username. Defaults to <code class="docutils literal notranslate"><span class="pre">.*</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">role</span></code> (optional): regex to match against role names. Defaults to <code class="docutils literal notranslate"><span class="pre">.*</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">group</span></code> (optional): regex to match against group names. Defaults to <code class="docutils literal notranslate"><span class="pre">.*</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">catalog</span></code> (optional): regex to match against catalog name. Defaults to
<code class="docutils literal notranslate"><span class="pre">.*</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">schema</span></code> (optional): regex to match against schema name. Defaults to
<code class="docutils literal notranslate"><span class="pre">.*</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">owner</span></code> (required): boolean indicating whether the user is to be considered
an owner of the schema. Defaults to <code class="docutils literal notranslate"><span class="pre">false</span></code>.</p></li>
</ul>
<p>For example, to provide ownership of all schemas to role <code class="docutils literal notranslate"><span class="pre">admin</span></code>, treat all
users as owners of the <code class="docutils literal notranslate"><span class="pre">default.default</span></code> schema and prevent user <code class="docutils literal notranslate"><span class="pre">guest</span></code>
from ownership of any schema, you can use the following rules:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;schemas&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;role&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;admin&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;schema&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;.*&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;owner&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;user&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;guest&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;owner&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;catalog&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;default&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;schema&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;default&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;owner&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
</div>
<h4 id="table-rules">Table rules<a class="headerlink" href="#table-rules" title="Link to this heading">#</a></h4>
<p>Each table rule is composed of the following fields:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">user</span></code> (optional): regex to match against username. Defaults to <code class="docutils literal notranslate"><span class="pre">.*</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">role</span></code> (optional): regex to match against role names. Defaults to <code class="docutils literal notranslate"><span class="pre">.*</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">group</span></code> (optional): regex to match against group names. Defaults to <code class="docutils literal notranslate"><span class="pre">.*</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">catalog</span></code> (optional): regex to match against catalog name. Defaults to
<code class="docutils literal notranslate"><span class="pre">.*</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">schema</span></code> (optional): regex to match against schema name. Defaults to <code class="docutils literal notranslate"><span class="pre">.*</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">table</span></code> (optional): regex to match against table names. Defaults to <code class="docutils literal notranslate"><span class="pre">.*</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">privileges</span></code> (required): zero or more of <code class="docutils literal notranslate"><span class="pre">SELECT</span></code>, <code class="docutils literal notranslate"><span class="pre">INSERT</span></code>,
<code class="docutils literal notranslate"><span class="pre">DELETE</span></code>, <code class="docutils literal notranslate"><span class="pre">UPDATE</span></code>, <code class="docutils literal notranslate"><span class="pre">OWNERSHIP</span></code>, <code class="docutils literal notranslate"><span class="pre">GRANT_SELECT</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">columns</span></code> (optional): list of column constraints.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">filter</span></code> (optional): boolean filter expression for the table.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">filter_environment</span></code> (optional): environment use during filter evaluation.</p></li>
</ul>
<h4 id="column-constraint">Column constraint<a class="headerlink" href="#column-constraint" title="Link to this heading">#</a></h4>
<p>These constraints can be used to restrict access to column data.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code>: name of the column.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">allow</span></code> (optional): if false, column can not be accessed.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mask</span></code> (optional): mask expression applied to column.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mask_environment</span></code> (optional): environment use during mask evaluation.</p></li>
</ul>
<h4 id="filter-and-mask-environment">Filter and mask environment<a class="headerlink" href="#filter-and-mask-environment" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">user</span></code> (optional): username for checking permission of subqueries in mask.</p></li>
</ul>
<div class="note admonition">
<p class="admonition-title">Note</p>
<p>These rules do not apply to <code class="docutils literal notranslate"><span class="pre">information_schema</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">mask</span></code> can contain conditional expressions such as <code class="docutils literal notranslate"><span class="pre">IF</span></code> or <code class="docutils literal notranslate"><span class="pre">CASE</span></code>, which achieves conditional masking.</p>
</div>
<p>The example below defines the following table access policy:</p>
<ul class="simple">
<li><p>Role <code class="docutils literal notranslate"><span class="pre">admin</span></code> has all privileges across all tables and schemas</p></li>
<li><p>User <code class="docutils literal notranslate"><span class="pre">banned_user</span></code> has no privileges</p></li>
<li><p>All users have <code class="docutils literal notranslate"><span class="pre">SELECT</span></code> privileges on <code class="docutils literal notranslate"><span class="pre">default.hr.employees</span></code>, but the
table is filtered to only the row for the current user.</p></li>
<li><p>All users have <code class="docutils literal notranslate"><span class="pre">SELECT</span></code> privileges on all tables in the <code class="docutils literal notranslate"><span class="pre">default.default</span></code>
schema, except for the <code class="docutils literal notranslate"><span class="pre">address</span></code> column which is blocked, and <code class="docutils literal notranslate"><span class="pre">ssn</span></code> which
is masked.</p></li>
</ul>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;tables&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;role&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;admin&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;privileges&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;SELECT&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;INSERT&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;DELETE&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;UPDATE&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;OWNERSHIP&quot;</span><span class="p">]</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;user&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;banned_user&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;privileges&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;catalog&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;default&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;schema&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;hr&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;table&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;employee&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;privileges&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;SELECT&quot;</span><span class="p">],</span>
<span class="w">      </span><span class="nt">&quot;filter&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;user = current_user&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;filter_environment&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;user&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;system_user&quot;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;catalog&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;default&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;schema&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;default&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;table&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;.*&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;privileges&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;SELECT&quot;</span><span class="p">],</span>
<span class="w">      </span><span class="nt">&quot;columns&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">         </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;address&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;allow&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span>
<span class="w">         </span><span class="p">},</span>
<span class="w">         </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;SSN&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;mask&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&#39;XXX-XX-&#39; + substring(credit_card, -4)&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;mask_environment&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="nt">&quot;user&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;system_user&quot;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">         </span><span class="p">}</span>
<span class="w">      </span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
</div>
<h4 id="function-rules"><span id="system-file-function-rules"></span>Function rules<a class="headerlink" href="#function-rules" title="Link to this heading">#</a></h4>
<p>These rules control the ability of a user to create, drop, and execute functions.</p>
<p>When these rules are present, the authorization is based on the first matching
rule, processed from top to bottom. If no rules match, the authorization is
denied. If function rules are not present, only functions in<code class="docutils literal notranslate"><span class="pre">system.builtin</span></code> can
be executed.</p>
<div class="note admonition">
<p class="admonition-title">Note</p>
<p>Users always have access to functions in the <code class="docutils literal notranslate"><span class="pre">system.builtin</span></code> schema, and
you cannot override this behavior by adding a rule.</p>
</div>
<p>Each function rule is composed of the following fields:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">user</span></code> (optional): regular expression to match against username.
Defaults to <code class="docutils literal notranslate"><span class="pre">.*</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">role</span></code> (optional): regular expression to match against role names.
Defaults to <code class="docutils literal notranslate"><span class="pre">.*</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">group</span></code> (optional): regular expression to match against group names.
Defaults to <code class="docutils literal notranslate"><span class="pre">.*</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">catalog</span></code> (optional): regular expression to match against catalog name.
Defaults to <code class="docutils literal notranslate"><span class="pre">.*</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">schema</span></code> (optional): regular expression to match against schema name.
Defaults to <code class="docutils literal notranslate"><span class="pre">.*</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">function</span></code> (optional): regular expression to match against function names.
Defaults to <code class="docutils literal notranslate"><span class="pre">.*</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">privileges</span></code> (required): zero or more of <code class="docutils literal notranslate"><span class="pre">EXECUTE</span></code>, <code class="docutils literal notranslate"><span class="pre">GRANT_EXECUTE</span></code>, <code class="docutils literal notranslate"><span class="pre">OWNERSHIP</span></code>.</p></li>
</ul>
<p>Care should be taken when granting permission to the <code class="docutils literal notranslate"><span class="pre">system</span></code> schema of a
catalog, as this is the schema Trino uses for table function such as <code class="docutils literal notranslate"><span class="pre">query</span></code>.
These table functions can be used to access or modify the underlying data of
the catalog.</p>
<p>The following example allows the <code class="docutils literal notranslate"><span class="pre">admin</span></code> user to execute <code class="docutils literal notranslate"><span class="pre">system.query</span></code> table function in
any catalog, and allows all users to create, drop, and execute functions (including
<code class="docutils literal notranslate"><span class="pre">SECURITY</span> <span class="pre">DEFINER</span></code> views) in the <code class="docutils literal notranslate"><span class="pre">hive.function</span></code> schema:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;functions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;user&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;admin&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;schema&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;system&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;function&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;query&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;privileges&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="s2">&quot;EXECUTE&quot;</span>
<span class="w">      </span><span class="p">]</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;catalog&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;hive&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;schema&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;function&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;privileges&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="s2">&quot;EXECUTE&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;GRANT_EXECUTE&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;OWNERSHIP&quot;</span>
<span class="w">      </span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
</div>
<h4 id="procedure-rules"><span id="system-file-procedure-rules"></span>Procedure rules<a class="headerlink" href="#procedure-rules" title="Link to this heading">#</a></h4>
<p>These rules control the ability of a user to execute procedures using the
<a class="reference internal" href="../sql/call.html"><span class="doc std std-doc">CALL</span></a> statement.</p>
<p>Procedures are used for administrative operations on a specific catalog, such as
registering external tables or flushing the connector’s cache. Available
procedures are detailed in the connector documentation pages.</p>
<p>When procedure rules are present, the authorization is based on the first
matching rule, processed from top to bottom. If no rules match, the
authorization is denied. If procedure rules are not present, only procedures in
<code class="docutils literal notranslate"><span class="pre">system.builtin</span></code> can be executed.</p>
<p>Each procedure rule is composed of the following fields:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">user</span></code> (optional): regular expression to match against username.
Defaults to <code class="docutils literal notranslate"><span class="pre">.*</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">role</span></code> (optional): regular expression to match against role names.
Defaults to <code class="docutils literal notranslate"><span class="pre">.*</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">group</span></code> (optional): regular expression to match against group names.
Defaults to <code class="docutils literal notranslate"><span class="pre">.*</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">catalog</span></code> (optional): regular expression to match against catalog name.
Defaults to <code class="docutils literal notranslate"><span class="pre">.*</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">schema</span></code> (optional): regular expression to match against schema name.
Defaults to <code class="docutils literal notranslate"><span class="pre">.*</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">procedure</span></code> (optional): regular expression to match against procedure names.
Defaults to <code class="docutils literal notranslate"><span class="pre">.*</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">privileges</span></code> (required): zero or more of <code class="docutils literal notranslate"><span class="pre">EXECUTE</span></code>, <code class="docutils literal notranslate"><span class="pre">GRANT_EXECUTE</span></code>.</p></li>
</ul>
<p>The following example allows the <code class="docutils literal notranslate"><span class="pre">admin</span></code> user to execute and grant execution
rights to call <code class="docutils literal notranslate"><span class="pre">register_table</span></code> and <code class="docutils literal notranslate"><span class="pre">unregister_table</span></code> in the <code class="docutils literal notranslate"><span class="pre">system</span></code> schema of
a catalog called  <code class="docutils literal notranslate"><span class="pre">delta</span></code>, that uses the <a class="reference internal" href="../connector/delta-lake.html"><span class="doc std std-doc">Delta Lake
connector</span></a>. It allows all users to execute the
<code class="docutils literal notranslate"><span class="pre">delta.sytem.vacuum</span></code> procedure.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;procedures&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;user&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;admin&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;catalog&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;delta&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;schema&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;system&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;procedure&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;register_table|unregister_table&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;privileges&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="s2">&quot;EXECUTE&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;GRANT_EXECUTE&quot;</span>
<span class="w">      </span><span class="p">]</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;catalog&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;delta&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;schema&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;system&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;procedure&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;vacuum&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;privileges&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="s2">&quot;EXECUTE&quot;</span>
<span class="w">      </span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
</div>
<h4 id="table-procedure-rules"><span id="system-file-table-procedure-rules"></span>Table procedure rules<a class="headerlink" href="#table-procedure-rules" title="Link to this heading">#</a></h4>
<p>Table procedures are executed using the
<a class="reference internal" href="../sql/alter-table.html#alter-table-execute"><span class="std std-ref">ALTER TABLE … EXECUTE</span></a> syntax.</p>
<p>File-based access control does not support privileges for table procedures and
therefore all are effectively allowed.</p>
<h4 id="verify-configuration"><span id="verify-rules"></span>Verify configuration<a class="headerlink" href="#verify-configuration" title="Link to this heading">#</a></h4>
<p>To verify the system-access control file is configured properly, set the
rules to completely block access to all users of the system:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;catalogs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;catalog&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;system&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;allow&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;none&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
</div>
<p>Restart your cluster to activate the rules for your cluster. With the
Trino <a class="reference internal" href="../client/cli.html"><span class="doc">CLI</span></a> run a query to test authorization:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><code>trino&gt; SELECT * FROM system.runtime.nodes;
Query 20200824_183358_00000_c62aw failed: Access Denied: Cannot access catalog system
</code></pre></div>
</div>
<p>Remove these rules and restart the Trino cluster.</p>
<h3 id="session-property-rules"><span id="system-file-auth-session-property"></span>Session property rules<a class="headerlink" href="#session-property-rules" title="Link to this heading">#</a></h3>
<p>These rules control the ability of a user to set system and catalog session
properties. The user is granted or denied access, based on the first matching
rule, read from top to bottom. If no rules are specified, all users are allowed
set any session property. If no rule matches, setting the session property is
denied. System session property rules are composed of the following fields:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">user</span></code> (optional): regex to match against username. Defaults to <code class="docutils literal notranslate"><span class="pre">.*</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">role</span></code> (optional): regex to match against role names. Defaults to <code class="docutils literal notranslate"><span class="pre">.*</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">group</span></code> (optional): regex to match against group names. Defaults to <code class="docutils literal notranslate"><span class="pre">.*</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">property</span></code> (optional): regex to match against the property name. Defaults to
<code class="docutils literal notranslate"><span class="pre">.*</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">allow</span></code> (required): boolean indicating if the setting the session
property should be allowed.</p></li>
</ul>
<p>The catalog session property rules have the additional field:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">catalog</span></code> (optional): regex to match against catalog name. Defaults to
<code class="docutils literal notranslate"><span class="pre">.*</span></code>.</p></li>
</ul>
<p>The example below defines the following table access policy:</p>
<ul class="simple">
<li><p>Role <code class="docutils literal notranslate"><span class="pre">admin</span></code> can set all session property</p></li>
<li><p>User <code class="docutils literal notranslate"><span class="pre">banned_user</span></code> can not set any session properties</p></li>
<li><p>All users can set the <code class="docutils literal notranslate"><span class="pre">resource_overcommit</span></code> system session property, and the
<code class="docutils literal notranslate"><span class="pre">bucket_execution_enabled</span></code> session property in the <code class="docutils literal notranslate"><span class="pre">hive</span></code> catalog.</p></li>
</ul>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;system_session_properties&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;role&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;admin&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;allow&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;user&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;banned_user&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;allow&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;property&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;resource_overcommit&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;allow&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;catalog_session_properties&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;role&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;admin&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;allow&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;user&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;banned_user&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;allow&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;catalog&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;hive&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;property&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;bucket_execution_enabled&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;allow&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
</div>
<h3 id="query-rules"><span id="id1"></span>Query rules<a class="headerlink" href="#query-rules" title="Link to this heading">#</a></h3>
<p>These rules control the ability of a user to execute, view, or kill a query. The
user is granted or denied access, based on the first matching rule read from top
to bottom. If no rules are specified, all users are allowed to execute queries,
and to view or kill queries owned by any user. If no rule matches, query
management is denied. Each rule is composed of the following fields:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">user</span></code> (optional): regex to match against username. Defaults to <code class="docutils literal notranslate"><span class="pre">.*</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">role</span></code> (optional): regex to match against role names. Defaults to <code class="docutils literal notranslate"><span class="pre">.*</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">group</span></code> (optional): regex to match against group names. Defaults to <code class="docutils literal notranslate"><span class="pre">.*</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">queryOwner</span></code> (optional): regex to match against the query owner name.
Defaults to <code class="docutils literal notranslate"><span class="pre">.*</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">allow</span></code> (required): set of query permissions granted to user. Values:
<code class="docutils literal notranslate"><span class="pre">execute</span></code>, <code class="docutils literal notranslate"><span class="pre">view</span></code>, <code class="docutils literal notranslate"><span class="pre">kill</span></code></p></li>
</ul>
<div class="note admonition">
<p class="admonition-title">Note</p>
<p>Users always have permission to view or kill their own queries.</p>
<p>A rule that includes <code class="docutils literal notranslate"><span class="pre">queryOwner</span></code> may not include the <code class="docutils literal notranslate"><span class="pre">execute</span></code> access mode.
Queries are only owned by a user once their execution has begun.</p>
</div>
<p>For example, if you want to allow the role <code class="docutils literal notranslate"><span class="pre">admin</span></code> full query access, allow
the user <code class="docutils literal notranslate"><span class="pre">alice</span></code> to execute and kill queries, allow members of the group
<code class="docutils literal notranslate"><span class="pre">contractors</span></code> to view queries owned by users <code class="docutils literal notranslate"><span class="pre">alice</span></code> or <code class="docutils literal notranslate"><span class="pre">dave</span></code>, allow any
user to execute queries, and deny all other access, you can use the following
rules:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;queries&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;role&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;admin&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;allow&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;execute&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;kill&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;view&quot;</span><span class="p">]</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;user&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;alice&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;allow&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;execute&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;kill&quot;</span><span class="p">]</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;group&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;contractors&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;queryOwner&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;alice|dave&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;allow&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;view&quot;</span><span class="p">]</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;allow&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;execute&quot;</span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
</div>
<h3 id="impersonation-rules"><span id="system-file-auth-impersonation-rules"></span>Impersonation rules<a class="headerlink" href="#impersonation-rules" title="Link to this heading">#</a></h3>
<p>These rules control the ability of a user to impersonate another user. In
some environments it is desirable for an administrator (or managed system) to
run queries on behalf of other users. In these cases, the administrator
authenticates using their credentials, and then submits a query as a different
user. When the user context is changed, Trino verifies that the administrator
is authorized to run queries as the target user.</p>
<p>When these rules are present, the authorization is based on the first matching
rule, processed from top to bottom. If no rules match, the authorization is
denied. If impersonation rules are not present but the legacy principal rules
are specified, it is assumed impersonation access control is being handled by
the principal rules, so impersonation is allowed. If neither impersonation nor
principal rules are defined, impersonation is not allowed.</p>
<p>Each impersonation rule is composed of the following fields:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">original_user</span></code> (optional): regex to match against the user requesting the
impersonation. Defaults to <code class="docutils literal notranslate"><span class="pre">.*</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">original_role</span></code> (optional): regex to match against role names of the
requesting impersonation. Defaults to <code class="docutils literal notranslate"><span class="pre">.*</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">new_user</span></code> (required): regex to match against the user to impersonate. Can
contain references to subsequences captured during the match against
<em>original_user</em>, and each reference is replaced by the result of evaluating
the corresponding group respectively.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">allow</span></code> (optional): boolean indicating if the authentication should be
allowed. Defaults to <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p></li>
</ul>
<p>The impersonation rules are a bit different from the other rules: The attribute
<code class="docutils literal notranslate"><span class="pre">new_user</span></code> is required to not accidentally prevent more access than intended.
Doing so it was possible to make the attribute <code class="docutils literal notranslate"><span class="pre">allow</span></code> optional.</p>
<p>The following example allows the <code class="docutils literal notranslate"><span class="pre">admin</span></code> role, to impersonate any user, except
for <code class="docutils literal notranslate"><span class="pre">bob</span></code>. It also allows any user to impersonate the <code class="docutils literal notranslate"><span class="pre">test</span></code> user. It also
allows a user in the form <code class="docutils literal notranslate"><span class="pre">team_backend</span></code> to impersonate the
<code class="docutils literal notranslate"><span class="pre">team_backend_sandbox</span></code> user, but not arbitrary users:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;impersonation&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;original_role&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;admin&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;new_user&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;bob&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;allow&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;original_role&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;admin&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;new_user&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;.*&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;original_user&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;.*&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;new_user&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;test&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;original_user&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;team_(.*)&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;new_user&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;team_$1_sandbox&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;allow&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
</div>
<h3 id="principal-rules"><span id="system-file-auth-principal-rules"></span>Principal rules<a class="headerlink" href="#principal-rules" title="Link to this heading">#</a></h3>
<div class="warning admonition">
<p class="admonition-title">Warning</p>
<p>Principal rules are deprecated. Instead, use <a class="reference internal" href="user-mapping.html"><span class="doc">User mapping</span></a>
which specifies how a complex authentication username is mapped to a simple
username for Trino, and impersonation rules defined above.</p>
</div>
<p>These rules serve to enforce a specific matching between a principal and a
specified username. The principal is granted authorization as a user, based
on the first matching rule read from top to bottom. If no rules are specified,
no checks are performed. If no rule matches, user authorization is denied.
Each rule is composed of the following fields:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">principal</span></code> (required): regex to match and group against principal.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">user</span></code> (optional): regex to match against username. If matched, it
grants or denies the authorization based on the value of <code class="docutils literal notranslate"><span class="pre">allow</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">principal_to_user</span></code> (optional): replacement string to substitute against
principal. If the result of the substitution is same as the username, it
grants or denies the authorization based on the value of <code class="docutils literal notranslate"><span class="pre">allow</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">allow</span></code> (required): boolean indicating whether a principal can be authorized
as a user.</p></li>
</ul>
<div class="note admonition">
<p class="admonition-title">Note</p>
<p>You would at least specify one criterion in a principal rule. If you specify
both criteria in a principal rule, it returns the desired conclusion when
either of criteria is satisfied.</p>
</div>
<p>The following implements an exact matching of the full principal name for LDAP
and Kerberos authentication:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;principals&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;principal&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;(.*)&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;principal_to_user&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;$1&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;allow&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;principal&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;([^/]+)(/.*)?@.*&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;principal_to_user&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;$1&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;allow&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
</div>
<p>If you want to allow users to use the exact same name as their Kerberos
principal name, and allow <code class="docutils literal notranslate"><span class="pre">alice</span></code> and <code class="docutils literal notranslate"><span class="pre">bob</span></code> to use a group principal named
as <code class="docutils literal notranslate"><span class="pre">group&#64;example.net</span></code>, you can use the following rules.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;principals&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;principal&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;([^/]+)/?.*@example.net&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;principal_to_user&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;$1&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;allow&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;principal&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;group@example.net&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;user&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;alice|bob&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;allow&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
</div>
<h3 id="system-information-rules"><span id="system-file-auth-system-information"></span>System information rules<a class="headerlink" href="#system-information-rules" title="Link to this heading">#</a></h3>
<p>These rules specify which users can access the system information management
interface. System information access includes the following aspects:</p>
<ul class="simple">
<li><p>Read access to sensitive information from REST endpoints, such as <code class="docutils literal notranslate"><span class="pre">/v1/node</span></code>
and <code class="docutils literal notranslate"><span class="pre">/v1/thread</span></code>.</p></li>
<li><p>Read access with the <a class="reference internal" href="../functions/system.html"><span class="doc">system information functions</span></a>.</p></li>
<li><p>Read access with the <a class="reference internal" href="../connector/system.html"><span class="doc">System connector</span></a>.</p></li>
<li><p>Write access to trigger <a class="reference internal" href="../admin/graceful-shutdown.html"><span class="doc">Graceful shutdown</span></a>.</p></li>
</ul>
<p>The following REST endpoints are always public and not affected by these rules:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">GET</span> <span class="pre">/v1/info</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">GET</span> <span class="pre">/v1/info/state</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">GET</span> <span class="pre">/v1/status</span></code></p></li>
</ul>
<p>The user is granted or denied access based on the first matching
rule read from top to bottom. If no rules are specified, all access to system
information is denied. If no rule matches, system access is denied. Each rule is
composed of the following fields:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">role</span></code> (optional): regex to match against role. If matched, it
grants or denies the authorization based on the value of <code class="docutils literal notranslate"><span class="pre">allow</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">user</span></code> (optional): regex to match against username. If matched, it
grants or denies the authorization based on the value of <code class="docutils literal notranslate"><span class="pre">allow</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">allow</span></code> (required): set of access permissions granted to user. Values:
<code class="docutils literal notranslate"><span class="pre">read</span></code>, <code class="docutils literal notranslate"><span class="pre">write</span></code></p></li>
</ul>
<p>The following configuration provides and example:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;system_information&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;role&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;admin&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;allow&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;read&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;write&quot;</span><span class="p">]</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;user&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;alice&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;allow&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;read&quot;</span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
</div>
<ul class="simple">
<li><p>All users with the <code class="docutils literal notranslate"><span class="pre">admin</span></code> role have read and write access to system
information. This includes the ability to trigger
<a class="reference internal" href="../admin/graceful-shutdown.html"><span class="doc">Graceful shutdown</span></a>.</p></li>
<li><p>The user <code class="docutils literal notranslate"><span class="pre">alice</span></code> can read system information.</p></li>
<li><p>All other users and roles are denied access to system information.</p></li>
</ul>
<p>A fixed user can be set for management interfaces using the <code class="docutils literal notranslate"><span class="pre">management.user</span></code>
configuration property.  When this is configured, system information rules must
still be set to authorize this user to read or write to management information.
The fixed management user only applies to HTTP by default. To enable the fixed
user over HTTPS, set the <code class="docutils literal notranslate"><span class="pre">management.user.https-enabled</span></code> configuration
property.</p>
<h3 id="authorization-rules"><span id="system-file-auth-authorization"></span>Authorization rules<a class="headerlink" href="#authorization-rules" title="Link to this heading">#</a></h3>
<p>These rules control the ability of how owner of schema, table or view can
be altered. These rules are applicable to commands like:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">ALTER</span><span class="w"> </span><span class="k">SCHEMA</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="k">AUTHORIZATION</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="k">user</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">USER</span><span class="w"> </span><span class="k">user</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">ROLE</span><span class="w"> </span><span class="k">role</span><span class="w"> </span><span class="p">)</span>
<span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="k">AUTHORIZATION</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="k">user</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">USER</span><span class="w"> </span><span class="k">user</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">ROLE</span><span class="w"> </span><span class="k">role</span><span class="w"> </span><span class="p">)</span>
<span class="k">ALTER</span><span class="w"> </span><span class="k">VIEW</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="k">AUTHORIZATION</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="k">user</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">USER</span><span class="w"> </span><span class="k">user</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">ROLE</span><span class="w"> </span><span class="k">role</span><span class="w"> </span><span class="p">)</span>
</code></pre></div>
</div>
<p>When these rules are present, the authorization is based on the first matching
rule, processed from top to bottom. If no rules match, the authorization is
denied.</p>
<p>Notice that in order to execute <code class="docutils literal notranslate"><span class="pre">ALTER</span></code> command on schema, table or view user requires <code class="docutils literal notranslate"><span class="pre">OWNERSHIP</span></code>
privilege.</p>
<p>Each authorization rule is composed of the following fields:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">original_user</span></code> (optional): regex to match against the user requesting the
authorization. Defaults to <code class="docutils literal notranslate"><span class="pre">.*</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">original_group</span></code> (optional): regex to match against group names of the
requesting authorization. Defaults to <code class="docutils literal notranslate"><span class="pre">.*</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">original_role</span></code> (optional): regex to match against role names of the
requesting authorization. Defaults to <code class="docutils literal notranslate"><span class="pre">.*</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">new_user</span></code> (optional): regex to match against the new owner user of the schema, table or view.
By default it does not match.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">new_role</span></code> (optional): regex to match against the new owner role of the schema, table or view.
By default it does not match.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">allow</span></code> (optional): boolean indicating if the authentication should be
allowed. Defaults to <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p></li>
</ul>
<p>Notice that <code class="docutils literal notranslate"><span class="pre">new_user</span></code> and <code class="docutils literal notranslate"><span class="pre">new_role</span></code> are optional, however it is required to provide at least one of them.</p>
<p>The following example allows the <code class="docutils literal notranslate"><span class="pre">admin</span></code> role, to change owner of any schema, table or view
to any user, except to``bob``.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;authorization&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;original_role&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;admin&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;new_user&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;bob&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;allow&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;original_role&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;admin&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;new_user&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;.*&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;new_role&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;.*&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">],</span>
<span class="w">  </span><span class="nt">&quot;schemas&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;role&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;admin&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;owner&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">],</span>
<span class="w">  </span><span class="nt">&quot;tables&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;role&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;admin&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;privileges&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;OWNERSHIP&quot;</span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
</div>
<h2 id="catalog-level-access-control-files"><span id="catalog-file-based-access-control"></span>Catalog-level access control files<a class="headerlink" href="#catalog-level-access-control-files" title="Link to this heading">#</a></h2>
<p>You can create JSON files for individual catalogs that define authorization
rules specific to that catalog. To enable catalog-level access control files,
add a connector-specific catalog configuration property that sets the
authorization type to <code class="docutils literal notranslate"><span class="pre">FILE</span></code> and the <code class="docutils literal notranslate"><span class="pre">security.config-file</span></code> catalog
configuration property that specifies the JSON rules file.</p>
<p>For example, the following Iceberg catalog configuration properties use the
<code class="docutils literal notranslate"><span class="pre">rules.json</span></code> file for catalog-level access control:</p>
<div class="highlight-properties notranslate"><div class="highlight"><pre><span></span><code><span class="na">iceberg.security</span><span class="o">=</span><span class="s">FILE</span>
<span class="na">security.config-file</span><span class="o">=</span><span class="s">etc/catalog/rules.json</span>
</code></pre></div>
</div>
<p>Catalog-level access control files are supported on a per-connector basis, refer
to the connector documentation for more information.</p>
<div class="note admonition">
<p class="admonition-title">Note</p>
<p>These rules do not apply to system-defined tables in the
<code class="docutils literal notranslate"><span class="pre">information_schema</span></code> schema.</p>
</div>
<h3 id="configure-a-catalog-rules-file">Configure a catalog rules file<a class="headerlink" href="#configure-a-catalog-rules-file" title="Link to this heading">#</a></h3>
<p>The configuration file is specified in JSON format. This file is composed of
the following sections, each of which is a list of rules that are processed in
order from top to bottom:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">schemas</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tables</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">session_properties</span></code></p></li>
</ol>
<p>The user is granted the privileges from the first matching rule. All regexes
default to <code class="docutils literal notranslate"><span class="pre">.*</span></code> if not specified.</p>
<h4 id="id2">Schema rules<a class="headerlink" href="#id2" title="Link to this heading">#</a></h4>
<p>These rules govern who is considered an owner of a schema.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">user</span></code> (optional): regex to match against username.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">group</span></code> (optional): regex to match against every user group the user belongs
to.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">schema</span></code> (optional): regex to match against schema name.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">owner</span></code> (required): boolean indicating ownership.</p></li>
</ul>
<h4 id="id3">Table rules<a class="headerlink" href="#id3" title="Link to this heading">#</a></h4>
<p>These rules govern the privileges granted on specific tables.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">user</span></code> (optional): regex to match against username.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">group</span></code> (optional): regex to match against every user group the user belongs
to.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">schema</span></code> (optional): regex to match against schema name.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">table</span></code> (optional): regex to match against table name.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">privileges</span></code> (required): zero or more of <code class="docutils literal notranslate"><span class="pre">SELECT</span></code>, <code class="docutils literal notranslate"><span class="pre">INSERT</span></code>,
<code class="docutils literal notranslate"><span class="pre">DELETE</span></code>, <code class="docutils literal notranslate"><span class="pre">UPDATE</span></code>, <code class="docutils literal notranslate"><span class="pre">OWNERSHIP</span></code>, <code class="docutils literal notranslate"><span class="pre">GRANT_SELECT</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">columns</span></code> (optional): list of column constraints.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">filter</span></code> (optional): boolean filter expression for the table.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">filter_environment</span></code> (optional): environment used during filter evaluation.</p></li>
</ul>
<h5 id="column-constraints">Column constraints<a class="headerlink" href="#column-constraints" title="Link to this heading">#</a></h5>
<p>These constraints can be used to restrict access to column data.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code>: name of the column.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">allow</span></code> (optional): if false, column can not be accessed.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mask</span></code> (optional): mask expression applied to column.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mask_environment</span></code> (optional): environment use during mask evaluation.</p></li>
</ul>
<h5 id="filter-environment-and-mask-environment">Filter environment and mask environment<a class="headerlink" href="#filter-environment-and-mask-environment" title="Link to this heading">#</a></h5>
<p>These rules apply to <code class="docutils literal notranslate"><span class="pre">filter_environment</span></code> and <code class="docutils literal notranslate"><span class="pre">mask_environment</span></code>.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">user</span></code> (optional): username for checking permission of subqueries in a mask.</p></li>
</ul>
<div class="note admonition">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">mask</span></code> can contain conditional expressions such as <code class="docutils literal notranslate"><span class="pre">IF</span></code> or <code class="docutils literal notranslate"><span class="pre">CASE</span></code>, which achieves conditional masking.</p>
</div>
<h4 id="id4">Function rules<a class="headerlink" href="#id4" title="Link to this heading">#</a></h4>
<p>These rules control the ability of a user to create, drop, and execute functions.</p>
<p>When these rules are present, the authorization is based on the first matching
rule, processed from top to bottom. If no rules match, the authorization is
denied. If function rules are not present, access is not allowed.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">user</span></code> (optional): regular expression to match against username.
Defaults to <code class="docutils literal notranslate"><span class="pre">.*</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">group</span></code> (optional): regular expression to match against group names.
Defaults to <code class="docutils literal notranslate"><span class="pre">.*</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">schema</span></code> (optional): regular expression to match against schema name.
Defaults to <code class="docutils literal notranslate"><span class="pre">.*</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">function</span></code> (optional): regular expression to match against function names.
Defaults to <code class="docutils literal notranslate"><span class="pre">.*</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">privileges</span></code> (required): zero or more of <code class="docutils literal notranslate"><span class="pre">EXECUTE</span></code>, <code class="docutils literal notranslate"><span class="pre">GRANT_EXECUTE</span></code>, <code class="docutils literal notranslate"><span class="pre">OWNERSHIP</span></code>.</p></li>
</ul>
<p>Care should be taken when granting permission to the <code class="docutils literal notranslate"><span class="pre">system</span></code> schema of a
catalog, as this is the schema Trino uses for table function such as <code class="docutils literal notranslate"><span class="pre">query</span></code>.
These table functions can be used to access or modify the underlying data of
the catalog.</p>
<p>The following example allows the <code class="docutils literal notranslate"><span class="pre">admin</span></code> user to execute <code class="docutils literal notranslate"><span class="pre">system.query</span></code> table function from
any catalog, and all users to create, drop, and execute functions (including from views)
in the <code class="docutils literal notranslate"><span class="pre">function</span></code> schema of this catalog:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;functions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;user&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;admin&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;schema&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;system&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;function&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;query&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;privileges&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="s2">&quot;EXECUTE&quot;</span>
<span class="w">      </span><span class="p">]</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;schema&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;function&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;privileges&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="s2">&quot;EXECUTE&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;GRANT_EXECUTE&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;OWNERSHIP&quot;</span>
<span class="w">      </span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
</div>
<h4 id="id5">Session property rules<a class="headerlink" href="#id5" title="Link to this heading">#</a></h4>
<p>These rules govern who may set session properties.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">user</span></code> (optional): regex to match against username.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">group</span></code> (optional): regex to match against every user group the user belongs
to.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">property</span></code> (optional): regex to match against session property name.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">allow</span></code> (required): boolean indicating whether this session property may be
set.</p></li>
</ul>
<h3 id="example">Example<a class="headerlink" href="#example" title="Link to this heading">#</a></h3>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;schemas&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;user&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;admin&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;schema&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;.*&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;owner&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;group&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;finance|human_resources&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;schema&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;employees&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;owner&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;user&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;guest&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;owner&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;schema&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;default&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;owner&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">],</span>
<span class="w">  </span><span class="nt">&quot;tables&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;user&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;admin&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;privileges&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;SELECT&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;INSERT&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;DELETE&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;UPDATE&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;OWNERSHIP&quot;</span><span class="p">]</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;user&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;banned_user&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;privileges&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;schema&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;hr&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;table&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;employee&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;privileges&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;SELECT&quot;</span><span class="p">],</span>
<span class="w">      </span><span class="nt">&quot;filter&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;user = current_user&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;schema&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;default&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;table&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;.*&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;privileges&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;SELECT&quot;</span><span class="p">],</span>
<span class="w">      </span><span class="nt">&quot;columns&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">         </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;address&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;allow&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span>
<span class="w">         </span><span class="p">},</span>
<span class="w">         </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ssn&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;mask&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&#39;XXX-XX-&#39; + substring(credit_card, -4)&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;mask_environment&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="nt">&quot;user&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;admin&quot;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">         </span><span class="p">}</span>
<span class="w">      </span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">],</span>
<span class="w">  </span><span class="nt">&quot;session_properties&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;property&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;force_local_scheduling&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;allow&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;user&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;admin&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;property&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;max_split_size&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;allow&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
</div>







  
  






                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="built-in-system-access-control.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: System access control">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                System access control
              </div>
            </div>
          </a>
        
        
          
          <a href="opa-access-control.html" class="md-footer__link md-footer__link--next" aria-label="Next: Open Policy Agent access control">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Open Policy Agent access control
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  
  
  <div class="md-footer-meta md-typeset">
    
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["content.action.edit", "content.action.view", "content.code.copy", "content.tabs.link", "content.tooltipsnavigation.expand", "navigation.footer", "navigation.top", "navigation.tracking", "search.share", "search.suggest", "toc.integrate", "toc.follow"], "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike", "staticVersions": null, "versionPath": "../versions.json"}}</script>
    
      
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/sphinx_immaterial_theme.32136f45f91ae6956.min.js?v=a7a9472a"></script>
        <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../_static/copybutton.js?v=f281be69"></script>
    
  </body>
</html>